[0m16:15:44.604160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e17b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107867c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107867ed0>]}


============================== 16:15:44.605936 | cddbc61b-de93-4711-9617-ba151724b3ae ==============================
[0m16:15:44.605936 [info ] [MainThread]: Running with dbt=1.10.15
[0m16:15:44.606194 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'use_colors': 'True', 'static_parser': 'True', 'profiles_dir': '.', 'write_json': 'True', 'fail_fast': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'log_path': '/Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/logs', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'no_print': 'None', 'warn_error': 'None', 'target_path': 'None', 'invocation_command': 'dbt run --select staging marts --profiles-dir .', 'log_format': 'default', 'empty': 'False'}
[0m16:15:44.607716 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'nfl_dead_money'
[0m16:15:44.608727 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.029555459, "process_in_blocks": "0", "process_kernel_time": 0.106337, "process_mem_max_rss": "126861312", "process_out_blocks": "0", "process_user_time": 0.888703}
[0m16:15:44.608903 [debug] [MainThread]: Command `dbt run` failed at 16:15:44.608867 after 0.03 seconds
[0m16:15:44.609025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a9e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10767ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075cbbd0>]}
[0m16:15:44.609139 [debug] [MainThread]: Flushing usage events
[0m16:15:45.347208 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:16:07.343085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11122bb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113963c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113963ed0>]}


============================== 16:16:07.344742 | 43934dc2-eed4-42d7-abe1-74b92a572172 ==============================
[0m16:16:07.344742 [info ] [MainThread]: Running with dbt=1.10.15
[0m16:16:07.345004 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'profiles_dir': '.', 'quiet': 'False', 'fail_fast': 'False', 'write_json': 'True', 'log_format': 'default', 'partial_parse': 'True', 'empty': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'target_path': 'None', 'invocation_command': 'dbt parse --profiles-dir .', 'debug': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'log_path': '/Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/logs', 'printer_width': '80', 'warn_error': 'None'}
[0m16:16:08.684661 [error] [MainThread]: Encountered an error:
Runtime Error
  Required "name" field not present in project

Error encountered in /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/dbt_project.yml
[0m16:16:08.686315 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 1.3672422, "process_in_blocks": "0", "process_kernel_time": 0.083294, "process_mem_max_rss": "131186688", "process_out_blocks": "0", "process_user_time": 0.818171}
[0m16:16:08.686581 [debug] [MainThread]: Command `dbt parse` failed at 16:16:08.686524 after 1.37 seconds
[0m16:16:08.686765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ba88a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b7f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b299d0>]}
[0m16:16:08.686965 [debug] [MainThread]: Flushing usage events
[0m16:16:09.247274 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:16:21.034080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106953b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109567c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109567ed0>]}


============================== 16:16:21.035731 | d986833c-7b34-4ae8-93f0-f254c9b2b6b2 ==============================
[0m16:16:21.035731 [info ] [MainThread]: Running with dbt=1.10.15
[0m16:16:21.035942 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'quiet': 'False', 'warn_error': 'None', 'empty': 'None', 'printer_width': '80', 'version_check': 'True', 'fail_fast': 'False', 'debug': 'False', 'invocation_command': 'dbt parse --profiles-dir .', 'introspect': 'True', 'use_colors': 'True', 'log_format': 'default', 'profiles_dir': '.', 'no_print': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': '/Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/logs', 'cache_selected_only': 'False', 'partial_parse': 'True', 'static_parser': 'True'}
[0m16:16:21.091885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd986833c-7b34-4ae8-93f0-f254c9b2b6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078b10f0>]}
[0m16:16:21.113700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd986833c-7b34-4ae8-93f0-f254c9b2b6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093cbce0>]}
[0m16:16:21.114167 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m16:16:21.154957 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m16:16:21.155293 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:16:21.155435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd986833c-7b34-4ae8-93f0-f254c9b2b6b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095f1b50>]}
[0m16:16:21.157491 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading nfl_dead_money: staging/stg_spotrac_team_cap.yml - Runtime Error
    Syntax error near line 4
    ------------------------------
    1  | -- models/staging/stg_spotrac_team_cap.yml
    2  | # Staging layer schema for Spotrac team cap
    3  | 
    4  | version: 2
    5  | 
    6  | models:
    7  |   - name: stg_spotrac_team_cap
    
    Raw Error:
    ------------------------------
    did not find expected <document start>
      in "<unicode string>", line 4, column 1
[0m16:16:21.158756 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 0.14844567, "process_in_blocks": "0", "process_kernel_time": 0.090832, "process_mem_max_rss": "138133504", "process_out_blocks": "0", "process_user_time": 0.871052}
[0m16:16:21.158978 [debug] [MainThread]: Command `dbt parse` failed at 16:16:21.158938 after 0.15 seconds
[0m16:16:21.159126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aad0e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aad0f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109427e70>]}
[0m16:16:21.159247 [debug] [MainThread]: Flushing usage events
[0m16:16:21.603923 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:16:33.104148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085dbb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a363c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a363ed0>]}


============================== 16:16:33.106312 | db3b6833-6e6f-4990-ad5e-0a8dbdb5c05e ==============================
[0m16:16:33.106312 [info ] [MainThread]: Running with dbt=1.10.15
[0m16:16:33.106606 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'profiles_dir': '.', 'fail_fast': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'invocation_command': 'dbt parse --profiles-dir .', 'empty': 'None', 'static_parser': 'True', 'warn_error': 'None', 'version_check': 'True', 'printer_width': '80', 'introspect': 'True', 'use_colors': 'True', 'target_path': 'None', 'partial_parse': 'True', 'log_path': '/Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/logs', 'log_format': 'default', 'quiet': 'False'}
[0m16:16:33.162355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db3b6833-6e6f-4990-ad5e-0a8dbdb5c05e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092b10f0>]}
[0m16:16:33.182299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db3b6833-6e6f-4990-ad5e-0a8dbdb5c05e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0cbce0>]}
[0m16:16:33.182692 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m16:16:33.217656 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m16:16:33.218008 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:16:33.218147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'db3b6833-6e6f-4990-ad5e-0a8dbdb5c05e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3edb50>]}
[0m16:16:33.220568 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading nfl_dead_money: marts/_marts.yml - Runtime Error
    Syntax error near line 4
    ------------------------------
    1  | -- models/marts/_marts.yml
    2  | # Mart layer documentation and tests
    3  | 
    4  | version: 2
    5  | 
    6  | models:
    7  |   - name: dim_teams
    
    Raw Error:
    ------------------------------
    did not find expected <document start>
      in "<unicode string>", line 4, column 1
[0m16:16:33.221767 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 0.14150266, "process_in_blocks": "0", "process_kernel_time": 0.088993, "process_mem_max_rss": "133332992", "process_out_blocks": "0", "process_user_time": 0.86776}
[0m16:16:33.221956 [debug] [MainThread]: Command `dbt parse` failed at 16:16:33.221919 after 0.14 seconds
[0m16:16:33.222109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0d07d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0d0c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a127e70>]}
[0m16:16:33.222229 [debug] [MainThread]: Flushing usage events
[0m16:16:33.686176 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:16:44.723382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10618bb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107963c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107963ed0>]}


============================== 16:16:44.725483 | 5d709ef7-c88f-4b64-a7b6-36f5feb35270 ==============================
[0m16:16:44.725483 [info ] [MainThread]: Running with dbt=1.10.15
[0m16:16:44.725754 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'invocation_command': 'dbt parse --profiles-dir .', 'log_path': '/Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/logs', 'use_experimental_parser': 'False', 'profiles_dir': '.', 'partial_parse': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'printer_width': '80', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'quiet': 'False', 'debug': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'warn_error': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False'}
[0m16:16:44.782037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d709ef7-c88f-4b64-a7b6-36f5feb35270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b10f0>]}
[0m16:16:44.802054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d709ef7-c88f-4b64-a7b6-36f5feb35270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077cbce0>]}
[0m16:16:44.802430 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m16:16:44.836801 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m16:16:44.837128 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:16:44.837257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5d709ef7-c88f-4b64-a7b6-36f5feb35270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079edb50>]}
[0m16:16:45.178020 [info ] [MainThread]: Starting dbt run for NFL dead money data pipeline
[0m16:16:45.179442 [info ] [MainThread]: Completed dbt run
[0m16:16:45.235623 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.accepted_range`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m16:16:45.235835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5d709ef7-c88f-4b64-a7b6-36f5feb35270', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c5a7b0>]}
[0m16:16:45.286401 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nfl_dead_money.stg_player_dead_money' (models/staging/stg_player_dead_money.sql) depends on a source named 'raw.player_dead_money_raw' which was not found
[0m16:16:45.286674 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 6 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:16:45.287891 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 0.58894855, "process_in_blocks": "0", "process_kernel_time": 0.103204, "process_mem_max_rss": "145539072", "process_out_blocks": "0", "process_user_time": 1.30887}
[0m16:16:45.288051 [debug] [MainThread]: Command `dbt parse` failed at 16:16:45.288020 after 0.59 seconds
[0m16:16:45.288178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782be70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1182119b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a324e0>]}
[0m16:16:45.288293 [debug] [MainThread]: Flushing usage events
[0m16:16:45.759932 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:17:32.892389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110837b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112767c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112767ed0>]}


============================== 16:17:32.894058 | c60142be-95d3-4997-9cf1-5eb017d8fb85 ==============================
[0m16:17:32.894058 [info ] [MainThread]: Running with dbt=1.10.15
[0m16:17:32.894265 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'target_path': 'None', 'write_json': 'True', 'log_format': 'default', 'invocation_command': 'dbt parse --profiles-dir .', 'cache_selected_only': 'False', 'profiles_dir': '.', 'empty': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'no_print': 'None', 'printer_width': '80', 'log_path': '/Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/logs', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m16:17:32.949604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c60142be-95d3-4997-9cf1-5eb017d8fb85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110eb50f0>]}
[0m16:17:32.969563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c60142be-95d3-4997-9cf1-5eb017d8fb85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125cbce0>]}
[0m16:17:32.969946 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m16:17:33.006121 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m16:17:33.006473 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:17:33.006614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c60142be-95d3-4997-9cf1-5eb017d8fb85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127e9b50>]}
[0m16:17:33.345622 [info ] [MainThread]: Starting dbt run for NFL dead money data pipeline
[0m16:17:33.347021 [info ] [MainThread]: Completed dbt run
[0m16:17:33.402920 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.accepted_range`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m16:17:33.403154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c60142be-95d3-4997-9cf1-5eb017d8fb85', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dca7b0>]}
[0m16:17:33.454501 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nfl_dead_money.stg_spotrac_dead_money' (models/staging/stg_spotrac_dead_money.sql) depends on a node named 'spotrac_dead_money' which was not found
[0m16:17:33.454776 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 6 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:17:33.455942 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": false, "command_wall_clock_time": 0.58752376, "process_in_blocks": "0", "process_kernel_time": 0.111811, "process_mem_max_rss": "150552576", "process_out_blocks": "0", "process_user_time": 1.313899}
[0m16:17:33.456097 [debug] [MainThread]: Command `dbt parse` failed at 16:17:33.456067 after 0.59 seconds
[0m16:17:33.456225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112627e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11363a0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139c7a00>]}
[0m16:17:33.456342 [debug] [MainThread]: Flushing usage events
[0m16:17:34.128773 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:18:27.596446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10831bb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae67c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae67ed0>]}


============================== 16:18:27.598098 | 65df0bb7-ad25-4e12-b635-b78010a8520d ==============================
[0m16:18:27.598098 [info ] [MainThread]: Running with dbt=1.10.15
[0m16:18:27.598303 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'write_json': 'True', 'profiles_dir': '.', 'partial_parse': 'True', 'quiet': 'False', 'use_colors': 'True', 'log_format': 'default', 'fail_fast': 'False', 'log_path': '/Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/logs', 'warn_error': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'empty': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt parse --profiles-dir .', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'no_print': 'None'}
[0m16:18:27.653613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65df0bb7-ad25-4e12-b635-b78010a8520d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089b10f0>]}
[0m16:18:27.675979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65df0bb7-ad25-4e12-b635-b78010a8520d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10accbce0>]}
[0m16:18:27.676436 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m16:18:27.714028 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m16:18:27.714439 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:18:27.714578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '65df0bb7-ad25-4e12-b635-b78010a8520d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeedb50>]}
[0m16:18:28.054499 [info ] [MainThread]: Starting dbt run for NFL dead money data pipeline
[0m16:18:28.055944 [info ] [MainThread]: Completed dbt run
[0m16:18:28.114171 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.accepted_range`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m16:18:28.114397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '65df0bb7-ad25-4e12-b635-b78010a8520d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf3ad50>]}
[0m16:18:28.194447 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.nfl_dead_money.spotrac_team_cap
[0m16:18:28.197803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65df0bb7-ad25-4e12-b635-b78010a8520d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3eb850>]}
[0m16:18:28.199041 [info ] [MainThread]: Performance info: /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/perf_info.json
[0m16:18:28.232591 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/manifest.json
[0m16:18:28.233349 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/semantic_manifest.json
[0m16:18:28.233556 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 6 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:18:28.234628 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 0.66193944, "process_in_blocks": "0", "process_kernel_time": 0.113404, "process_mem_max_rss": "149143552", "process_out_blocks": "0", "process_user_time": 1.386365}
[0m16:18:28.234774 [debug] [MainThread]: Command `dbt parse` succeeded at 16:18:28.234745 after 0.66 seconds
[0m16:18:28.234891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf99300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acc6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1e34d0>]}
[0m16:18:28.235001 [debug] [MainThread]: Flushing usage events
[0m16:18:28.839888 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:18:39.567830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113887b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115667c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115667ed0>]}


============================== 16:18:39.569577 | 14bfcedd-2011-4e5b-a9ba-5b969fd8fe0f ==============================
[0m16:18:39.569577 [info ] [MainThread]: Running with dbt=1.10.15
[0m16:18:39.569794 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '.', 'no_print': 'None', 'partial_parse': 'True', 'version_check': 'True', 'log_path': '/Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/logs', 'use_experimental_parser': 'False', 'printer_width': '80', 'invocation_command': 'dbt compile --select fct_dead_money_trend fct_dead_money_by_year fct_dead_money_by_player --profiles-dir .', 'write_json': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'quiet': 'False', 'introspect': 'True', 'fail_fast': 'False'}
[0m16:18:39.626359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14bfcedd-2011-4e5b-a9ba-5b969fd8fe0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144b50f0>]}
[0m16:18:39.648005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14bfcedd-2011-4e5b-a9ba-5b969fd8fe0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154cbce0>]}
[0m16:18:39.648436 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m16:18:39.685792 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m16:18:39.730191 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:18:39.730363 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:18:39.732339 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.nfl_dead_money.spotrac_team_cap
[0m16:18:39.749419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14bfcedd-2011-4e5b-a9ba-5b969fd8fe0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156f5650>]}
[0m16:18:39.784863 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/manifest.json
[0m16:18:39.785718 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/semantic_manifest.json
[0m16:18:39.792160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14bfcedd-2011-4e5b-a9ba-5b969fd8fe0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115e2b4d0>]}
[0m16:18:39.792371 [info ] [MainThread]: Found 10 models, 2 operations, 34 data tests, 4 sources, 460 macros
[0m16:18:39.792496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14bfcedd-2011-4e5b-a9ba-5b969fd8fe0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115523070>]}
[0m16:18:39.793474 [info ] [MainThread]: 
[0m16:18:39.793601 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:18:39.793685 [info ] [MainThread]: 
[0m16:18:39.793879 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:18:39.795272 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nfl_dead_money_public_marts'
[0m16:18:39.830108 [debug] [ThreadPool]: Using postgres connection "list_nfl_dead_money_public_marts"
[0m16:18:39.830267 [debug] [ThreadPool]: On list_nfl_dead_money_public_marts: BEGIN
[0m16:18:39.830356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:39.844558 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m16:18:39.846222 [debug] [ThreadPool]: Postgres adapter: Error running SQL: BEGIN
[0m16:18:39.846341 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:18:39.846476 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_relations_without_caching
[0m16:18:39.846563 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:18:39.846652 [debug] [ThreadPool]: On list_nfl_dead_money_public_marts: No close available on handle
[0m16:18:39.846830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfl_dead_money_public_marts, now list_nfl_dead_money_public_intermediate)
[0m16:18:39.847458 [debug] [ThreadPool]: Using postgres connection "list_nfl_dead_money_public_intermediate"
[0m16:18:39.847552 [debug] [ThreadPool]: On list_nfl_dead_money_public_intermediate: BEGIN
[0m16:18:39.847629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:18:39.849320 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m16:18:39.850756 [debug] [ThreadPool]: Postgres adapter: Error running SQL: BEGIN
[0m16:18:39.850893 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:18:39.851013 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_relations_without_caching
[0m16:18:39.851104 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:18:39.851186 [debug] [ThreadPool]: On list_nfl_dead_money_public_intermediate: No close available on handle
[0m16:18:39.851320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfl_dead_money_public_intermediate, now list_nfl_dead_money_public_staging)
[0m16:18:39.851822 [debug] [ThreadPool]: Using postgres connection "list_nfl_dead_money_public_staging"
[0m16:18:39.851924 [debug] [ThreadPool]: On list_nfl_dead_money_public_staging: BEGIN
[0m16:18:39.852009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:18:39.853189 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m16:18:39.854331 [debug] [ThreadPool]: Postgres adapter: Error running SQL: BEGIN
[0m16:18:39.854434 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:18:39.854526 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_relations_without_caching
[0m16:18:39.854601 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:18:39.854678 [debug] [ThreadPool]: On list_nfl_dead_money_public_staging: No close available on handle
[0m16:18:39.854873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:18:39.854958 [debug] [MainThread]: Connection 'list_nfl_dead_money_public_staging' was properly closed.
[0m16:18:39.855103 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m16:18:39.856226 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.31214485, "process_in_blocks": "0", "process_kernel_time": 0.117334, "process_mem_max_rss": "150618112", "process_out_blocks": "0", "process_user_time": 1.000186}
[0m16:18:39.856385 [debug] [MainThread]: Command `dbt compile` failed at 16:18:39.856351 after 0.31 seconds
[0m16:18:39.856694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1167f35f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154c6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116752ed0>]}
[0m16:18:39.856813 [debug] [MainThread]: Flushing usage events
[0m16:18:40.311101 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:20:44.374242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e7bb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c567c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c567ed0>]}


============================== 16:20:44.375943 | c4ddd367-c2e4-48c5-ab45-b950915b5509 ==============================
[0m16:20:44.375943 [info ] [MainThread]: Running with dbt=1.10.15
[0m16:20:44.376159 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'invocation_command': 'dbt seed --profiles-dir .', 'log_path': '/Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/logs', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'empty': 'None', 'printer_width': '80', 'profiles_dir': '.', 'static_parser': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'fail_fast': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'use_colors': 'True', 'warn_error': 'None', 'log_format': 'default', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False'}
[0m16:20:44.845201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4ddd367-c2e4-48c5-ab45-b950915b5509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aab50f0>]}
[0m16:20:44.863515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4ddd367-c2e4-48c5-ab45-b950915b5509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c69dae0>]}
[0m16:20:44.864247 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:20:44.898827 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m16:20:44.938034 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:20:44.938223 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m16:20:44.938335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c4ddd367-c2e4-48c5-ab45-b950915b5509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ceb7d50>]}
[0m16:20:45.336877 [info ] [MainThread]: Starting dbt run for NFL dead money data pipeline
[0m16:20:45.338270 [info ] [MainThread]: Completed dbt run
[0m16:20:45.390426 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.accepted_range`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m16:20:45.390635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c4ddd367-c2e4-48c5-ab45-b950915b5509', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8aa7b0>]}
[0m16:20:45.471867 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.nfl_dead_money.spotrac_team_cap
[0m16:20:45.475399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4ddd367-c2e4-48c5-ab45-b950915b5509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec583d0>]}
[0m16:20:45.510203 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/manifest.json
[0m16:20:45.510972 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/semantic_manifest.json
[0m16:20:45.517585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4ddd367-c2e4-48c5-ab45-b950915b5509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee118b0>]}
[0m16:20:45.517770 [info ] [MainThread]: Found 10 models, 1 seed, 2 operations, 34 data tests, 4 sources, 469 macros
[0m16:20:45.517877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4ddd367-c2e4-48c5-ab45-b950915b5509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed80350>]}
[0m16:20:45.518671 [info ] [MainThread]: 
[0m16:20:45.518793 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:20:45.518874 [info ] [MainThread]: 
[0m16:20:45.519028 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:20:45.519338 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfl_dead_money'
[0m16:20:45.536977 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money"
[0m16:20:45.537109 [debug] [ThreadPool]: On list_nfl_dead_money: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nfl_dead_money"'
    
  
  
[0m16:20:45.537200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:45.543182 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:20:45.543666 [debug] [ThreadPool]: On list_nfl_dead_money: Close
[0m16:20:45.543905 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfl_dead_money, now create_nfl_dead_money_main)
[0m16:20:45.544068 [debug] [ThreadPool]: Creating schema "database: "nfl_dead_money"
schema: "main"
"
[0m16:20:45.546323 [debug] [ThreadPool]: Using duckdb connection "create_nfl_dead_money_main"
[0m16:20:45.546433 [debug] [ThreadPool]: On create_nfl_dead_money_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "create_nfl_dead_money_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nfl_dead_money'
        and type='sqlite'
    
  
[0m16:20:45.546515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:45.546842 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:20:45.547267 [debug] [ThreadPool]: Using duckdb connection "create_nfl_dead_money_main"
[0m16:20:45.547353 [debug] [ThreadPool]: On create_nfl_dead_money_main: BEGIN
[0m16:20:45.547501 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:20:45.547584 [debug] [ThreadPool]: Using duckdb connection "create_nfl_dead_money_main"
[0m16:20:45.547669 [debug] [ThreadPool]: On create_nfl_dead_money_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "create_nfl_dead_money_main"} */

    
    
        create schema if not exists "nfl_dead_money"."main"
    
[0m16:20:45.547858 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:20:45.548123 [debug] [ThreadPool]: On create_nfl_dead_money_main: COMMIT
[0m16:20:45.548211 [debug] [ThreadPool]: Using duckdb connection "create_nfl_dead_money_main"
[0m16:20:45.548285 [debug] [ThreadPool]: On create_nfl_dead_money_main: COMMIT
[0m16:20:45.548424 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:20:45.548514 [debug] [ThreadPool]: On create_nfl_dead_money_main: Close
[0m16:20:45.550334 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nfl_dead_money_main, now list_nfl_dead_money_main_intermediate)
[0m16:20:45.550524 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfl_dead_money_main_marts'
[0m16:20:45.552404 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_intermediate"
[0m16:20:45.552574 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfl_dead_money_main'
[0m16:20:45.552738 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfl_dead_money_main_staging'
[0m16:20:45.553237 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_marts"
[0m16:20:45.553345 [debug] [ThreadPool]: On list_nfl_dead_money_main_intermediate: BEGIN
[0m16:20:45.553778 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main"
[0m16:20:45.554335 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_staging"
[0m16:20:45.554429 [debug] [ThreadPool]: On list_nfl_dead_money_main_marts: BEGIN
[0m16:20:45.554513 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:45.554594 [debug] [ThreadPool]: On list_nfl_dead_money_main: BEGIN
[0m16:20:45.554673 [debug] [ThreadPool]: On list_nfl_dead_money_main_staging: BEGIN
[0m16:20:45.554757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:45.554896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:45.555008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:45.555177 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:20:45.555496 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:20:45.555607 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_intermediate"
[0m16:20:45.555721 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:20:45.555840 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_marts"
[0m16:20:45.555930 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:20:45.556037 [debug] [ThreadPool]: On list_nfl_dead_money_main_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money_main_intermediate"} */
select
      'nfl_dead_money' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'nfl_dead_money'
  
[0m16:20:45.556134 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main"
[0m16:20:45.556222 [debug] [ThreadPool]: On list_nfl_dead_money_main_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money_main_marts"} */
select
      'nfl_dead_money' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'nfl_dead_money'
  
[0m16:20:45.556311 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_staging"
[0m16:20:45.556471 [debug] [ThreadPool]: On list_nfl_dead_money_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money_main"} */
select
      'nfl_dead_money' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'nfl_dead_money'
  
[0m16:20:45.556604 [debug] [ThreadPool]: On list_nfl_dead_money_main_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money_main_staging"} */
select
      'nfl_dead_money' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'nfl_dead_money'
  
[0m16:20:45.562014 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:20:45.562176 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:20:45.562289 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:20:45.562680 [debug] [ThreadPool]: On list_nfl_dead_money_main_staging: ROLLBACK
[0m16:20:45.562804 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:20:45.563167 [debug] [ThreadPool]: On list_nfl_dead_money_main: ROLLBACK
[0m16:20:45.563609 [debug] [ThreadPool]: On list_nfl_dead_money_main_marts: ROLLBACK
[0m16:20:45.564093 [debug] [ThreadPool]: On list_nfl_dead_money_main_intermediate: ROLLBACK
[0m16:20:45.564638 [debug] [ThreadPool]: Failed to rollback 'list_nfl_dead_money_main_staging'
[0m16:20:45.564786 [debug] [ThreadPool]: On list_nfl_dead_money_main_staging: Close
[0m16:20:45.565039 [debug] [ThreadPool]: Failed to rollback 'list_nfl_dead_money_main'
[0m16:20:45.565376 [debug] [ThreadPool]: Failed to rollback 'list_nfl_dead_money_main_marts'
[0m16:20:45.565595 [debug] [ThreadPool]: Failed to rollback 'list_nfl_dead_money_main_intermediate'
[0m16:20:45.565684 [debug] [ThreadPool]: On list_nfl_dead_money_main: Close
[0m16:20:45.565783 [debug] [ThreadPool]: On list_nfl_dead_money_main_marts: Close
[0m16:20:45.565872 [debug] [ThreadPool]: On list_nfl_dead_money_main_intermediate: Close
[0m16:20:45.566264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4ddd367-c2e4-48c5-ab45-b950915b5509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed6b280>]}
[0m16:20:45.566429 [debug] [MainThread]: Using duckdb connection "master"
[0m16:20:45.566510 [debug] [MainThread]: On master: BEGIN
[0m16:20:45.566593 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:45.566775 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:20:45.566855 [debug] [MainThread]: On master: COMMIT
[0m16:20:45.566932 [debug] [MainThread]: Using duckdb connection "master"
[0m16:20:45.567008 [debug] [MainThread]: On master: COMMIT
[0m16:20:45.567144 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:20:45.569437 [info ] [MainThread]: Starting dbt run for NFL dead money data pipeline
[0m16:20:45.569569 [debug] [MainThread]: Writing injected SQL for node "operation.nfl_dead_money.nfl_dead_money-on-run-start-0"
[0m16:20:45.570972 [info ] [MainThread]: 1 of 1 START hook: nfl_dead_money.on-run-start.0 ............................... [RUN]
[0m16:20:45.571131 [info ] [MainThread]: 1 of 1 OK hook: nfl_dead_money.on-run-start.0 .................................. [[32mOK[0m in 0.00s]
[0m16:20:45.571230 [info ] [MainThread]: 
[0m16:20:45.571328 [debug] [MainThread]: On master: Close
[0m16:20:45.572605 [debug] [Thread-1 (]: Began running node seed.nfl_dead_money.spotrac_dead_money
[0m16:20:45.572788 [info ] [Thread-1 (]: 1 of 1 START seed file main.spotrac_dead_money ................................. [RUN]
[0m16:20:45.572921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nfl_dead_money_main_intermediate, now seed.nfl_dead_money.spotrac_dead_money)
[0m16:20:45.573024 [debug] [Thread-1 (]: Began compiling node seed.nfl_dead_money.spotrac_dead_money
[0m16:20:45.573123 [debug] [Thread-1 (]: Began executing node seed.nfl_dead_money.spotrac_dead_money
[0m16:20:45.582954 [debug] [Thread-1 (]: Using duckdb connection "seed.nfl_dead_money.spotrac_dead_money"
[0m16:20:45.583074 [debug] [Thread-1 (]: On seed.nfl_dead_money.spotrac_dead_money: BEGIN
[0m16:20:45.583166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:45.583387 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:20:45.583479 [debug] [Thread-1 (]: Using duckdb connection "seed.nfl_dead_money.spotrac_dead_money"
[0m16:20:45.583573 [debug] [Thread-1 (]: On seed.nfl_dead_money.spotrac_dead_money: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "node_id": "seed.nfl_dead_money.spotrac_dead_money"} */

    create table "nfl_dead_money"."main"."spotrac_dead_money" ("player_id" text,"player_name" text,"position" text,"team" text,"year" integer,"dead_cap_hit" float8,"is_king" boolean)
  
[0m16:20:45.583845 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:20:45.587422 [debug] [Thread-1 (]: Using duckdb connection "seed.nfl_dead_money.spotrac_dead_money"
[0m16:20:45.587532 [debug] [Thread-1 (]: On seed.nfl_dead_money.spotrac_dead_money: 
          COPY "nfl_dead_money"."main"."spotrac_dead_money" FROM '/Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/seeds/spotrac/spotrac_dead_money.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m16:20:45.590262 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:20:45.592031 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.nfl_dead_money.spotrac_dead_money"
[0m16:20:45.596269 [debug] [Thread-1 (]: On seed.nfl_dead_money.spotrac_dead_money: COMMIT
[0m16:20:45.596394 [debug] [Thread-1 (]: Using duckdb connection "seed.nfl_dead_money.spotrac_dead_money"
[0m16:20:45.596496 [debug] [Thread-1 (]: On seed.nfl_dead_money.spotrac_dead_money: COMMIT
[0m16:20:45.597004 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:20:45.597618 [debug] [Thread-1 (]: On seed.nfl_dead_money.spotrac_dead_money: Close
[0m16:20:45.598172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4ddd367-c2e4-48c5-ab45-b950915b5509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa33d90>]}
[0m16:20:45.598342 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file main.spotrac_dead_money ............................. [[32mINSERT 181[0m in 0.02s]
[0m16:20:45.598520 [debug] [Thread-1 (]: Finished running node seed.nfl_dead_money.spotrac_dead_money
[0m16:20:45.599046 [info ] [MainThread]: 
[0m16:20:45.599178 [debug] [MainThread]: Using duckdb connection "master"
[0m16:20:45.599268 [debug] [MainThread]: On master: BEGIN
[0m16:20:45.599348 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:20:45.599524 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:20:45.599607 [debug] [MainThread]: On master: COMMIT
[0m16:20:45.599692 [debug] [MainThread]: Using duckdb connection "master"
[0m16:20:45.599773 [debug] [MainThread]: On master: COMMIT
[0m16:20:45.599904 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:20:45.600679 [info ] [MainThread]: Completed dbt run
[0m16:20:45.600797 [debug] [MainThread]: Writing injected SQL for node "operation.nfl_dead_money.nfl_dead_money-on-run-end-0"
[0m16:20:45.600971 [info ] [MainThread]: 1 of 1 START hook: nfl_dead_money.on-run-end.0 ................................. [RUN]
[0m16:20:45.601101 [info ] [MainThread]: 1 of 1 OK hook: nfl_dead_money.on-run-end.0 .................................... [[32mOK[0m in 0.00s]
[0m16:20:45.601197 [debug] [MainThread]: On master: Close
[0m16:20:45.601305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:45.601390 [debug] [MainThread]: Connection 'seed.nfl_dead_money.spotrac_dead_money' was properly closed.
[0m16:20:45.601458 [debug] [MainThread]: Connection 'list_nfl_dead_money_main_marts' was properly closed.
[0m16:20:45.601522 [debug] [MainThread]: Connection 'list_nfl_dead_money_main' was properly closed.
[0m16:20:45.601586 [debug] [MainThread]: Connection 'list_nfl_dead_money_main_staging' was properly closed.
[0m16:20:45.601680 [info ] [MainThread]: 
[0m16:20:45.601774 [info ] [MainThread]: Finished running 2 project hooks, 1 seed in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m16:20:45.602036 [debug] [MainThread]: Command end result
[0m16:20:45.613045 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/manifest.json
[0m16:20:45.613689 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/semantic_manifest.json
[0m16:20:45.615647 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/run_results.json
[0m16:20:45.615745 [info ] [MainThread]: 
[0m16:20:45.615855 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:20:45.615942 [info ] [MainThread]: 
[0m16:20:45.616035 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m16:20:45.616208 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 6 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:20:45.617208 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.266364, "process_in_blocks": "0", "process_kernel_time": 0.149074, "process_mem_max_rss": "183697408", "process_out_blocks": "0", "process_user_time": 1.612642}
[0m16:20:45.617349 [debug] [MainThread]: Command `dbt seed` succeeded at 16:20:45.617321 after 1.27 seconds
[0m16:20:45.617463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ece19d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa49750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5dd6a0>]}
[0m16:20:45.617569 [debug] [MainThread]: Flushing usage events
[0m16:20:46.409020 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:20:54.658428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111ebb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114363c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114363ed0>]}


============================== 16:20:54.660434 | bbe1853f-dab5-4eff-8aa5-1f7d54f62e41 ==============================
[0m16:20:54.660434 [info ] [MainThread]: Running with dbt=1.10.15
[0m16:20:54.660689 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'target_path': 'None', 'log_format': 'default', 'empty': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select stg_spotrac_dead_money --profiles-dir .', 'warn_error': 'None', 'log_path': '/Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/logs', 'profiles_dir': '.', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'printer_width': '80', 'use_colors': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'version_check': 'True'}
[0m16:20:54.735085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbe1853f-dab5-4eff-8aa5-1f7d54f62e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121b10f0>]}
[0m16:20:54.753639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbe1853f-dab5-4eff-8aa5-1f7d54f62e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114591ae0>]}
[0m16:20:54.754418 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:20:54.791580 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m16:20:54.840878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:20:54.841059 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:20:54.843289 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.nfl_dead_money.spotrac_team_cap
[0m16:20:54.862830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbe1853f-dab5-4eff-8aa5-1f7d54f62e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1153b4a50>]}
[0m16:20:54.899882 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/manifest.json
[0m16:20:54.900686 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/semantic_manifest.json
[0m16:20:54.906668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbe1853f-dab5-4eff-8aa5-1f7d54f62e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115229220>]}
[0m16:20:54.906865 [info ] [MainThread]: Found 10 models, 1 seed, 2 operations, 34 data tests, 4 sources, 469 macros
[0m16:20:54.907001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbe1853f-dab5-4eff-8aa5-1f7d54f62e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11563c050>]}
[0m16:20:54.907890 [info ] [MainThread]: 
[0m16:20:54.908035 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:20:54.908131 [info ] [MainThread]: 
[0m16:20:54.908316 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:20:54.908665 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfl_dead_money'
[0m16:20:54.927037 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money"
[0m16:20:54.927217 [debug] [ThreadPool]: On list_nfl_dead_money: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nfl_dead_money"'
    
  
  
[0m16:20:54.927313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:54.932801 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:20:54.933272 [debug] [ThreadPool]: On list_nfl_dead_money: Close
[0m16:20:54.933510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfl_dead_money, now create_nfl_dead_money_main_staging)
[0m16:20:54.933659 [debug] [ThreadPool]: Creating schema "database: "nfl_dead_money"
schema: "main_staging"
"
[0m16:20:54.935761 [debug] [ThreadPool]: Using duckdb connection "create_nfl_dead_money_main_staging"
[0m16:20:54.935872 [debug] [ThreadPool]: On create_nfl_dead_money_main_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "create_nfl_dead_money_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nfl_dead_money'
        and type='sqlite'
    
  
[0m16:20:54.935965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:54.936241 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:20:54.936622 [debug] [ThreadPool]: Using duckdb connection "create_nfl_dead_money_main_staging"
[0m16:20:54.936705 [debug] [ThreadPool]: On create_nfl_dead_money_main_staging: BEGIN
[0m16:20:54.936851 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:20:54.936944 [debug] [ThreadPool]: Using duckdb connection "create_nfl_dead_money_main_staging"
[0m16:20:54.937034 [debug] [ThreadPool]: On create_nfl_dead_money_main_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "create_nfl_dead_money_main_staging"} */

    
    
        create schema if not exists "nfl_dead_money"."main_staging"
    
[0m16:20:54.937221 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:20:54.937467 [debug] [ThreadPool]: On create_nfl_dead_money_main_staging: COMMIT
[0m16:20:54.937554 [debug] [ThreadPool]: Using duckdb connection "create_nfl_dead_money_main_staging"
[0m16:20:54.937630 [debug] [ThreadPool]: On create_nfl_dead_money_main_staging: COMMIT
[0m16:20:54.937999 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:20:54.938107 [debug] [ThreadPool]: On create_nfl_dead_money_main_staging: Close
[0m16:20:54.939933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nfl_dead_money_main_staging, now list_nfl_dead_money_main_staging)
[0m16:20:54.940103 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfl_dead_money_main_marts'
[0m16:20:54.942046 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_staging"
[0m16:20:54.942211 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfl_dead_money_main_intermediate'
[0m16:20:54.942753 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_marts"
[0m16:20:54.942872 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfl_dead_money_main'
[0m16:20:54.942974 [debug] [ThreadPool]: On list_nfl_dead_money_main_staging: BEGIN
[0m16:20:54.943448 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_intermediate"
[0m16:20:54.943542 [debug] [ThreadPool]: On list_nfl_dead_money_main_marts: BEGIN
[0m16:20:54.944117 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main"
[0m16:20:54.944215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:54.944300 [debug] [ThreadPool]: On list_nfl_dead_money_main_intermediate: BEGIN
[0m16:20:54.944382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:54.944459 [debug] [ThreadPool]: On list_nfl_dead_money_main: BEGIN
[0m16:20:54.944585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:54.944735 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:20:54.944832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:54.944974 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:20:54.945080 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_staging"
[0m16:20:54.945217 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:20:54.945307 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_marts"
[0m16:20:54.945426 [debug] [ThreadPool]: On list_nfl_dead_money_main_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money_main_staging"} */
select
      'nfl_dead_money' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'nfl_dead_money'
  
[0m16:20:54.945528 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:20:54.945616 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_intermediate"
[0m16:20:54.945720 [debug] [ThreadPool]: On list_nfl_dead_money_main_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money_main_marts"} */
select
      'nfl_dead_money' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'nfl_dead_money'
  
[0m16:20:54.945878 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main"
[0m16:20:54.945981 [debug] [ThreadPool]: On list_nfl_dead_money_main_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money_main_intermediate"} */
select
      'nfl_dead_money' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'nfl_dead_money'
  
[0m16:20:54.946141 [debug] [ThreadPool]: On list_nfl_dead_money_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money_main"} */
select
      'nfl_dead_money' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'nfl_dead_money'
  
[0m16:20:54.951633 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:20:54.951803 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:20:54.951916 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:20:54.952314 [debug] [ThreadPool]: On list_nfl_dead_money_main_marts: ROLLBACK
[0m16:20:54.952408 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:20:54.952850 [debug] [ThreadPool]: On list_nfl_dead_money_main: ROLLBACK
[0m16:20:54.953219 [debug] [ThreadPool]: On list_nfl_dead_money_main_staging: ROLLBACK
[0m16:20:54.953580 [debug] [ThreadPool]: On list_nfl_dead_money_main_intermediate: ROLLBACK
[0m16:20:54.954123 [debug] [ThreadPool]: Failed to rollback 'list_nfl_dead_money_main_marts'
[0m16:20:54.954358 [debug] [ThreadPool]: Failed to rollback 'list_nfl_dead_money_main_staging'
[0m16:20:54.954553 [debug] [ThreadPool]: Failed to rollback 'list_nfl_dead_money_main_intermediate'
[0m16:20:54.954666 [debug] [ThreadPool]: On list_nfl_dead_money_main_marts: Close
[0m16:20:54.954824 [debug] [ThreadPool]: Failed to rollback 'list_nfl_dead_money_main'
[0m16:20:54.954909 [debug] [ThreadPool]: On list_nfl_dead_money_main_staging: Close
[0m16:20:54.954991 [debug] [ThreadPool]: On list_nfl_dead_money_main_intermediate: Close
[0m16:20:54.955093 [debug] [ThreadPool]: On list_nfl_dead_money_main: Close
[0m16:20:54.955657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbe1853f-dab5-4eff-8aa5-1f7d54f62e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155d3ee0>]}
[0m16:20:54.955817 [debug] [MainThread]: Using duckdb connection "master"
[0m16:20:54.955902 [debug] [MainThread]: On master: BEGIN
[0m16:20:54.955977 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:54.956153 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:20:54.956234 [debug] [MainThread]: On master: COMMIT
[0m16:20:54.956310 [debug] [MainThread]: Using duckdb connection "master"
[0m16:20:54.956382 [debug] [MainThread]: On master: COMMIT
[0m16:20:54.956542 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:20:54.959071 [info ] [MainThread]: Starting dbt run for NFL dead money data pipeline
[0m16:20:54.959234 [debug] [MainThread]: Writing injected SQL for node "operation.nfl_dead_money.nfl_dead_money-on-run-start-0"
[0m16:20:54.960689 [info ] [MainThread]: 1 of 1 START hook: nfl_dead_money.on-run-start.0 ............................... [RUN]
[0m16:20:54.960843 [info ] [MainThread]: 1 of 1 OK hook: nfl_dead_money.on-run-start.0 .................................. [[32mOK[0m in 0.00s]
[0m16:20:54.960943 [info ] [MainThread]: 
[0m16:20:54.961045 [debug] [MainThread]: On master: Close
[0m16:20:54.961895 [debug] [Thread-1 (]: Began running node model.nfl_dead_money.stg_spotrac_dead_money
[0m16:20:54.962059 [info ] [Thread-1 (]: 1 of 1 START sql table model main_staging.stg_spotrac_dead_money ............... [RUN]
[0m16:20:54.962192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nfl_dead_money_main_staging, now model.nfl_dead_money.stg_spotrac_dead_money)
[0m16:20:54.962293 [debug] [Thread-1 (]: Began compiling node model.nfl_dead_money.stg_spotrac_dead_money
[0m16:20:54.963448 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfl_dead_money.stg_spotrac_dead_money"
[0m16:20:54.963883 [debug] [Thread-1 (]: Began executing node model.nfl_dead_money.stg_spotrac_dead_money
[0m16:20:54.973757 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfl_dead_money.stg_spotrac_dead_money"
[0m16:20:54.974104 [debug] [Thread-1 (]: Using duckdb connection "model.nfl_dead_money.stg_spotrac_dead_money"
[0m16:20:54.974212 [debug] [Thread-1 (]: On model.nfl_dead_money.stg_spotrac_dead_money: BEGIN
[0m16:20:54.974308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:54.974533 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:20:54.974628 [debug] [Thread-1 (]: Using duckdb connection "model.nfl_dead_money.stg_spotrac_dead_money"
[0m16:20:54.974730 [debug] [Thread-1 (]: On model.nfl_dead_money.stg_spotrac_dead_money: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "node_id": "model.nfl_dead_money.stg_spotrac_dead_money"} */

  
    
    

    create  table
      "nfl_dead_money"."main_staging"."stg_spotrac_dead_money__dbt_tmp"
  
    as (
      

-- Stage raw Spotrac player dead money data
-- Source: data/staging/stg_spotrac_dead_money.csv (from ingestion layer)
-- Cleans column names, casts to correct types, applies light validation

-- For development: source from staging CSV directly
-- In production, would source from database table
select
  player_name,
  team,
  cast(year as integer) as year,
  cast(dead_cap_millions as decimal(10, 2)) as dead_cap_millions,
  position,
  is_king
from "nfl_dead_money"."staging"."spotrac_dead_money"
where dead_cap_millions > 0
order by year, team, dead_cap_millions desc
    );
  
  
[0m16:20:54.975321 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "node_id": "model.nfl_dead_money.stg_spotrac_dead_money"} */

  
    
    

    create  table
      "nfl_dead_money"."main_staging"."stg_spotrac_dead_money__dbt_tmp"
  
    as (
      

-- Stage raw Spotrac player dead money data
-- Source: data/staging/stg_spotrac_dead_money.csv (from ingestion layer)
-- Cleans column names, casts to correct types, applies light validation

-- For development: source from staging CSV directly
-- In production, would source from database table
select
  player_name,
  team,
  cast(year as integer) as year,
  cast(dead_cap_millions as decimal(10, 2)) as dead_cap_millions,
  position,
  is_king
from "nfl_dead_money"."staging"."spotrac_dead_money"
where dead_cap_millions > 0
order by year, team, dead_cap_millions desc
    );
  
  
[0m16:20:54.975436 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:20:54.975569 [debug] [Thread-1 (]: On model.nfl_dead_money.stg_spotrac_dead_money: ROLLBACK
[0m16:20:54.978732 [debug] [Thread-1 (]: Failed to rollback 'model.nfl_dead_money.stg_spotrac_dead_money'
[0m16:20:54.978863 [debug] [Thread-1 (]: On model.nfl_dead_money.stg_spotrac_dead_money: Close
[0m16:20:54.980079 [debug] [Thread-1 (]: Runtime Error in model stg_spotrac_dead_money (models/staging/stg_spotrac_dead_money.sql)
  Catalog Error: Table with name spotrac_dead_money does not exist!
  Did you mean "nfl_dead_money.spotrac_dead_money"?
  
  LINE 26: from "nfl_dead_money"."staging"."spotrac_dead_money"
                ^
[0m16:20:54.980638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe1853f-dab5-4eff-8aa5-1f7d54f62e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115ad8710>]}
[0m16:20:54.980841 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main_staging.stg_spotrac_dead_money ...... [[31mERROR[0m in 0.02s]
[0m16:20:54.981026 [debug] [Thread-1 (]: Finished running node model.nfl_dead_money.stg_spotrac_dead_money
[0m16:20:54.981187 [debug] [Thread-7 (]: Marking all children of 'model.nfl_dead_money.stg_spotrac_dead_money' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_spotrac_dead_money (models/staging/stg_spotrac_dead_money.sql)
  Catalog Error: Table with name spotrac_dead_money does not exist!
  Did you mean "nfl_dead_money.spotrac_dead_money"?
  
  LINE 26: from "nfl_dead_money"."staging"."spotrac_dead_money"
                ^.
[0m16:20:54.981883 [info ] [MainThread]: 
[0m16:20:54.982010 [debug] [MainThread]: Using duckdb connection "master"
[0m16:20:54.982093 [debug] [MainThread]: On master: BEGIN
[0m16:20:54.982170 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:20:54.982351 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:20:54.982436 [debug] [MainThread]: On master: COMMIT
[0m16:20:54.982522 [debug] [MainThread]: Using duckdb connection "master"
[0m16:20:54.982600 [debug] [MainThread]: On master: COMMIT
[0m16:20:54.982737 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:20:54.983529 [info ] [MainThread]: Completed dbt run
[0m16:20:54.983644 [debug] [MainThread]: Writing injected SQL for node "operation.nfl_dead_money.nfl_dead_money-on-run-end-0"
[0m16:20:54.983808 [info ] [MainThread]: 1 of 1 START hook: nfl_dead_money.on-run-end.0 ................................. [RUN]
[0m16:20:54.983938 [info ] [MainThread]: 1 of 1 OK hook: nfl_dead_money.on-run-end.0 .................................... [[32mOK[0m in 0.00s]
[0m16:20:54.984029 [debug] [MainThread]: On master: Close
[0m16:20:54.984135 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:54.984210 [debug] [MainThread]: Connection 'model.nfl_dead_money.stg_spotrac_dead_money' was properly closed.
[0m16:20:54.984280 [debug] [MainThread]: Connection 'list_nfl_dead_money_main_marts' was properly closed.
[0m16:20:54.984345 [debug] [MainThread]: Connection 'list_nfl_dead_money_main_intermediate' was properly closed.
[0m16:20:54.984410 [debug] [MainThread]: Connection 'list_nfl_dead_money_main' was properly closed.
[0m16:20:54.984502 [info ] [MainThread]: 
[0m16:20:54.984592 [info ] [MainThread]: Finished running 2 project hooks, 1 table model in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m16:20:54.984848 [debug] [MainThread]: Command end result
[0m16:20:55.040821 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/manifest.json
[0m16:20:55.041572 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/semantic_manifest.json
[0m16:20:55.043585 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/run_results.json
[0m16:20:55.043685 [info ] [MainThread]: 
[0m16:20:55.043805 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:20:55.043898 [info ] [MainThread]: 
[0m16:20:55.044014 [error] [MainThread]: [31mFailure in model stg_spotrac_dead_money (models/staging/stg_spotrac_dead_money.sql)[0m
[0m16:20:55.044120 [error] [MainThread]:   Runtime Error in model stg_spotrac_dead_money (models/staging/stg_spotrac_dead_money.sql)
  Catalog Error: Table with name spotrac_dead_money does not exist!
  Did you mean "nfl_dead_money.spotrac_dead_money"?
  
  LINE 26: from "nfl_dead_money"."staging"."spotrac_dead_money"
                ^
[0m16:20:55.044196 [info ] [MainThread]: 
[0m16:20:55.044290 [info ] [MainThread]:   compiled code at target/compiled/nfl_dead_money/models/staging/stg_spotrac_dead_money.sql
[0m16:20:55.044367 [info ] [MainThread]: 
[0m16:20:55.044457 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m16:20:55.045416 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.41169322, "process_in_blocks": "0", "process_kernel_time": 0.126276, "process_mem_max_rss": "170868736", "process_out_blocks": "0", "process_user_time": 1.1307}
[0m16:20:55.045559 [debug] [MainThread]: Command `dbt run` failed at 16:20:55.045530 after 0.41 seconds
[0m16:20:55.045680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156e3ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115236490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152363f0>]}
[0m16:20:55.045785 [debug] [MainThread]: Flushing usage events
[0m16:20:55.502843 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:21:06.822084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132ebb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d63c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d63ed0>]}


============================== 16:21:06.823796 | d33db5e1-0268-454a-b495-da10395673b6 ==============================
[0m16:21:06.823796 [info ] [MainThread]: Running with dbt=1.10.15
[0m16:21:06.824012 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'no_print': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'empty': 'False', 'printer_width': '80', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'static_parser': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_path': '/Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/logs', 'warn_error': 'None', 'invocation_command': 'dbt run --select stg_spotrac_dead_money --profiles-dir .', 'partial_parse': 'True', 'debug': 'False', 'profiles_dir': '.', 'target_path': 'None', 'indirect_selection': 'eager'}
[0m16:21:06.897428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd33db5e1-0268-454a-b495-da10395673b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ab50f0>]}
[0m16:21:06.917114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd33db5e1-0268-454a-b495-da10395673b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e99ae0>]}
[0m16:21:06.917951 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:21:06.955110 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m16:21:07.004858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:21:07.005366 [debug] [MainThread]: Partial parsing: updated file: nfl_dead_money://models/sources/spotrac.yml
[0m16:21:07.118124 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `dbt_utils.accepted_range`. Arguments to
generic tests should be nested under the `arguments` property.`
[0m16:21:07.118433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd33db5e1-0268-454a-b495-da10395673b6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1153b0250>]}
[0m16:21:07.258029 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.nfl_dead_money.spotrac_team_cap
[0m16:21:07.261982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd33db5e1-0268-454a-b495-da10395673b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115732f30>]}
[0m16:21:07.298856 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/manifest.json
[0m16:21:07.299721 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/semantic_manifest.json
[0m16:21:07.306517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd33db5e1-0268-454a-b495-da10395673b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1157518d0>]}
[0m16:21:07.306734 [info ] [MainThread]: Found 10 models, 1 seed, 2 operations, 34 data tests, 4 sources, 469 macros
[0m16:21:07.306860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd33db5e1-0268-454a-b495-da10395673b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a37790>]}
[0m16:21:07.307536 [info ] [MainThread]: 
[0m16:21:07.307650 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:21:07.307734 [info ] [MainThread]: 
[0m16:21:07.307894 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:21:07.308174 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfl_dead_money'
[0m16:21:07.324264 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money"
[0m16:21:07.324432 [debug] [ThreadPool]: On list_nfl_dead_money: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nfl_dead_money"'
    
  
  
[0m16:21:07.324529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:07.330801 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:21:07.331307 [debug] [ThreadPool]: On list_nfl_dead_money: Close
[0m16:21:07.331550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfl_dead_money, now create_nfl_dead_money_main_staging)
[0m16:21:07.331695 [debug] [ThreadPool]: Creating schema "database: "nfl_dead_money"
schema: "main_staging"
"
[0m16:21:07.333847 [debug] [ThreadPool]: Using duckdb connection "create_nfl_dead_money_main_staging"
[0m16:21:07.333946 [debug] [ThreadPool]: On create_nfl_dead_money_main_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "create_nfl_dead_money_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nfl_dead_money'
        and type='sqlite'
    
  
[0m16:21:07.334038 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:07.334651 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:21:07.335055 [debug] [ThreadPool]: Using duckdb connection "create_nfl_dead_money_main_staging"
[0m16:21:07.335138 [debug] [ThreadPool]: On create_nfl_dead_money_main_staging: BEGIN
[0m16:21:07.335303 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:21:07.335382 [debug] [ThreadPool]: Using duckdb connection "create_nfl_dead_money_main_staging"
[0m16:21:07.335465 [debug] [ThreadPool]: On create_nfl_dead_money_main_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "create_nfl_dead_money_main_staging"} */

    
    
        create schema if not exists "nfl_dead_money"."main_staging"
    
[0m16:21:07.335641 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:21:07.335882 [debug] [ThreadPool]: On create_nfl_dead_money_main_staging: COMMIT
[0m16:21:07.335973 [debug] [ThreadPool]: Using duckdb connection "create_nfl_dead_money_main_staging"
[0m16:21:07.336047 [debug] [ThreadPool]: On create_nfl_dead_money_main_staging: COMMIT
[0m16:21:07.336187 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:21:07.336270 [debug] [ThreadPool]: On create_nfl_dead_money_main_staging: Close
[0m16:21:07.338186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nfl_dead_money_main_staging, now list_nfl_dead_money_main_marts)
[0m16:21:07.338387 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfl_dead_money_main_staging'
[0m16:21:07.340302 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_marts"
[0m16:21:07.340486 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfl_dead_money_main_intermediate'
[0m16:21:07.340980 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_staging"
[0m16:21:07.341156 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfl_dead_money_main'
[0m16:21:07.341297 [debug] [ThreadPool]: On list_nfl_dead_money_main_marts: BEGIN
[0m16:21:07.341755 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_intermediate"
[0m16:21:07.341848 [debug] [ThreadPool]: On list_nfl_dead_money_main_staging: BEGIN
[0m16:21:07.342564 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main"
[0m16:21:07.342711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:07.342815 [debug] [ThreadPool]: On list_nfl_dead_money_main_intermediate: BEGIN
[0m16:21:07.342902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:07.342987 [debug] [ThreadPool]: On list_nfl_dead_money_main: BEGIN
[0m16:21:07.343159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:07.343355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:07.343465 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:21:07.343629 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:21:07.343800 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_marts"
[0m16:21:07.343907 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_staging"
[0m16:21:07.344010 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:21:07.344095 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:21:07.344198 [debug] [ThreadPool]: On list_nfl_dead_money_main_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money_main_marts"} */
select
      'nfl_dead_money' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'nfl_dead_money'
  
[0m16:21:07.344307 [debug] [ThreadPool]: On list_nfl_dead_money_main_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money_main_staging"} */
select
      'nfl_dead_money' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'nfl_dead_money'
  
[0m16:21:07.344408 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_intermediate"
[0m16:21:07.344494 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main"
[0m16:21:07.344728 [debug] [ThreadPool]: On list_nfl_dead_money_main_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money_main_intermediate"} */
select
      'nfl_dead_money' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'nfl_dead_money'
  
[0m16:21:07.344844 [debug] [ThreadPool]: On list_nfl_dead_money_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money_main"} */
select
      'nfl_dead_money' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'nfl_dead_money'
  
[0m16:21:07.350632 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:21:07.350787 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:21:07.350932 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:21:07.351368 [debug] [ThreadPool]: On list_nfl_dead_money_main_intermediate: ROLLBACK
[0m16:21:07.351493 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m16:21:07.351852 [debug] [ThreadPool]: On list_nfl_dead_money_main: ROLLBACK
[0m16:21:07.352258 [debug] [ThreadPool]: On list_nfl_dead_money_main_staging: ROLLBACK
[0m16:21:07.352801 [debug] [ThreadPool]: Failed to rollback 'list_nfl_dead_money_main_intermediate'
[0m16:21:07.353161 [debug] [ThreadPool]: On list_nfl_dead_money_main_marts: ROLLBACK
[0m16:21:07.353255 [debug] [ThreadPool]: On list_nfl_dead_money_main_intermediate: Close
[0m16:21:07.353415 [debug] [ThreadPool]: Failed to rollback 'list_nfl_dead_money_main'
[0m16:21:07.353599 [debug] [ThreadPool]: Failed to rollback 'list_nfl_dead_money_main_marts'
[0m16:21:07.353781 [debug] [ThreadPool]: Failed to rollback 'list_nfl_dead_money_main_staging'
[0m16:21:07.353885 [debug] [ThreadPool]: On list_nfl_dead_money_main: Close
[0m16:21:07.354052 [debug] [ThreadPool]: On list_nfl_dead_money_main_marts: Close
[0m16:21:07.354151 [debug] [ThreadPool]: On list_nfl_dead_money_main_staging: Close
[0m16:21:07.354674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd33db5e1-0268-454a-b495-da10395673b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1168d4350>]}
[0m16:21:07.354882 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:07.354982 [debug] [MainThread]: On master: BEGIN
[0m16:21:07.355065 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:21:07.355266 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:21:07.355346 [debug] [MainThread]: On master: COMMIT
[0m16:21:07.355426 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:07.355497 [debug] [MainThread]: On master: COMMIT
[0m16:21:07.355635 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:21:07.358283 [info ] [MainThread]: Starting dbt run for NFL dead money data pipeline
[0m16:21:07.358439 [debug] [MainThread]: Writing injected SQL for node "operation.nfl_dead_money.nfl_dead_money-on-run-start-0"
[0m16:21:07.359968 [info ] [MainThread]: 1 of 1 START hook: nfl_dead_money.on-run-start.0 ............................... [RUN]
[0m16:21:07.360129 [info ] [MainThread]: 1 of 1 OK hook: nfl_dead_money.on-run-start.0 .................................. [[32mOK[0m in 0.00s]
[0m16:21:07.360225 [info ] [MainThread]: 
[0m16:21:07.360326 [debug] [MainThread]: On master: Close
[0m16:21:07.361202 [debug] [Thread-1 (]: Began running node model.nfl_dead_money.stg_spotrac_dead_money
[0m16:21:07.361373 [info ] [Thread-1 (]: 1 of 1 START sql table model main_staging.stg_spotrac_dead_money ............... [RUN]
[0m16:21:07.361516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nfl_dead_money_main_marts, now model.nfl_dead_money.stg_spotrac_dead_money)
[0m16:21:07.361623 [debug] [Thread-1 (]: Began compiling node model.nfl_dead_money.stg_spotrac_dead_money
[0m16:21:07.362798 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfl_dead_money.stg_spotrac_dead_money"
[0m16:21:07.363086 [debug] [Thread-1 (]: Began executing node model.nfl_dead_money.stg_spotrac_dead_money
[0m16:21:07.373788 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfl_dead_money.stg_spotrac_dead_money"
[0m16:21:07.374159 [debug] [Thread-1 (]: Using duckdb connection "model.nfl_dead_money.stg_spotrac_dead_money"
[0m16:21:07.374265 [debug] [Thread-1 (]: On model.nfl_dead_money.stg_spotrac_dead_money: BEGIN
[0m16:21:07.374363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:07.374619 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:21:07.374711 [debug] [Thread-1 (]: Using duckdb connection "model.nfl_dead_money.stg_spotrac_dead_money"
[0m16:21:07.374818 [debug] [Thread-1 (]: On model.nfl_dead_money.stg_spotrac_dead_money: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "node_id": "model.nfl_dead_money.stg_spotrac_dead_money"} */

  
    
    

    create  table
      "nfl_dead_money"."main_staging"."stg_spotrac_dead_money__dbt_tmp"
  
    as (
      

-- Stage raw Spotrac player dead money data
-- Source: data/staging/stg_spotrac_dead_money.csv (from ingestion layer)
-- Cleans column names, casts to correct types, applies light validation

-- For development: source from staging CSV directly
-- In production, would source from database table
select
  player_name,
  team,
  cast(year as integer) as year,
  cast(dead_cap_millions as decimal(10, 2)) as dead_cap_millions,
  position,
  is_king
from "nfl_dead_money"."main"."spotrac_dead_money"
where dead_cap_millions > 0
order by year, team, dead_cap_millions desc
    );
  
  
[0m16:21:07.375280 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "node_id": "model.nfl_dead_money.stg_spotrac_dead_money"} */

  
    
    

    create  table
      "nfl_dead_money"."main_staging"."stg_spotrac_dead_money__dbt_tmp"
  
    as (
      

-- Stage raw Spotrac player dead money data
-- Source: data/staging/stg_spotrac_dead_money.csv (from ingestion layer)
-- Cleans column names, casts to correct types, applies light validation

-- For development: source from staging CSV directly
-- In production, would source from database table
select
  player_name,
  team,
  cast(year as integer) as year,
  cast(dead_cap_millions as decimal(10, 2)) as dead_cap_millions,
  position,
  is_king
from "nfl_dead_money"."main"."spotrac_dead_money"
where dead_cap_millions > 0
order by year, team, dead_cap_millions desc
    );
  
  
[0m16:21:07.375394 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:21:07.375527 [debug] [Thread-1 (]: On model.nfl_dead_money.stg_spotrac_dead_money: ROLLBACK
[0m16:21:07.377705 [debug] [Thread-1 (]: Failed to rollback 'model.nfl_dead_money.stg_spotrac_dead_money'
[0m16:21:07.377831 [debug] [Thread-1 (]: On model.nfl_dead_money.stg_spotrac_dead_money: Close
[0m16:21:07.379120 [debug] [Thread-1 (]: Runtime Error in model stg_spotrac_dead_money (models/staging/stg_spotrac_dead_money.sql)
  Binder Error: Referenced column "dead_cap_millions" not found in FROM clause!
  Candidate bindings: "dead_cap_hit", "team", "player_id", "year", "player_name"
  
  LINE 23:   cast(dead_cap_millions as decimal(10, 2)) as dead_cap_millions,
                  ^
[0m16:21:07.379841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd33db5e1-0268-454a-b495-da10395673b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169409f0>]}
[0m16:21:07.380114 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main_staging.stg_spotrac_dead_money ...... [[31mERROR[0m in 0.02s]
[0m16:21:07.380329 [debug] [Thread-1 (]: Finished running node model.nfl_dead_money.stg_spotrac_dead_money
[0m16:21:07.380525 [debug] [Thread-7 (]: Marking all children of 'model.nfl_dead_money.stg_spotrac_dead_money' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_spotrac_dead_money (models/staging/stg_spotrac_dead_money.sql)
  Binder Error: Referenced column "dead_cap_millions" not found in FROM clause!
  Candidate bindings: "dead_cap_hit", "team", "player_id", "year", "player_name"
  
  LINE 23:   cast(dead_cap_millions as decimal(10, 2)) as dead_cap_millions,
                  ^.
[0m16:21:07.381272 [info ] [MainThread]: 
[0m16:21:07.381404 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:07.381496 [debug] [MainThread]: On master: BEGIN
[0m16:21:07.381584 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:21:07.381835 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:21:07.381927 [debug] [MainThread]: On master: COMMIT
[0m16:21:07.382012 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:07.382093 [debug] [MainThread]: On master: COMMIT
[0m16:21:07.382255 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:21:07.383169 [info ] [MainThread]: Completed dbt run
[0m16:21:07.383318 [debug] [MainThread]: Writing injected SQL for node "operation.nfl_dead_money.nfl_dead_money-on-run-end-0"
[0m16:21:07.383525 [info ] [MainThread]: 1 of 1 START hook: nfl_dead_money.on-run-end.0 ................................. [RUN]
[0m16:21:07.383687 [info ] [MainThread]: 1 of 1 OK hook: nfl_dead_money.on-run-end.0 .................................... [[32mOK[0m in 0.00s]
[0m16:21:07.383787 [debug] [MainThread]: On master: Close
[0m16:21:07.383907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:21:07.383979 [debug] [MainThread]: Connection 'model.nfl_dead_money.stg_spotrac_dead_money' was properly closed.
[0m16:21:07.384046 [debug] [MainThread]: Connection 'list_nfl_dead_money_main_staging' was properly closed.
[0m16:21:07.384109 [debug] [MainThread]: Connection 'list_nfl_dead_money_main_intermediate' was properly closed.
[0m16:21:07.384171 [debug] [MainThread]: Connection 'list_nfl_dead_money_main' was properly closed.
[0m16:21:07.384268 [info ] [MainThread]: 
[0m16:21:07.384359 [info ] [MainThread]: Finished running 2 project hooks, 1 table model in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m16:21:07.384620 [debug] [MainThread]: Command end result
[0m16:21:07.395869 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/manifest.json
[0m16:21:07.396586 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/semantic_manifest.json
[0m16:21:07.398575 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/run_results.json
[0m16:21:07.398678 [info ] [MainThread]: 
[0m16:21:07.398793 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:21:07.398887 [info ] [MainThread]: 
[0m16:21:07.399005 [error] [MainThread]: [31mFailure in model stg_spotrac_dead_money (models/staging/stg_spotrac_dead_money.sql)[0m
[0m16:21:07.399114 [error] [MainThread]:   Runtime Error in model stg_spotrac_dead_money (models/staging/stg_spotrac_dead_money.sql)
  Binder Error: Referenced column "dead_cap_millions" not found in FROM clause!
  Candidate bindings: "dead_cap_hit", "team", "player_id", "year", "player_name"
  
  LINE 23:   cast(dead_cap_millions as decimal(10, 2)) as dead_cap_millions,
                  ^
[0m16:21:07.399197 [info ] [MainThread]: 
[0m16:21:07.399325 [info ] [MainThread]:   compiled code at target/compiled/nfl_dead_money/models/staging/stg_spotrac_dead_money.sql
[0m16:21:07.399452 [info ] [MainThread]: 
[0m16:21:07.399587 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m16:21:07.399784 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 6 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:21:07.400753 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.60265326, "process_in_blocks": "0", "process_kernel_time": 0.129731, "process_mem_max_rss": "176160768", "process_out_blocks": "0", "process_user_time": 1.324422}
[0m16:21:07.400903 [debug] [MainThread]: Command `dbt run` failed at 16:21:07.400873 after 0.60 seconds
[0m16:21:07.401026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115205090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11695f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a820d0>]}
[0m16:21:07.401140 [debug] [MainThread]: Flushing usage events
[0m16:21:07.888677 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:21:20.566580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f1bb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113667c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113667ed0>]}


============================== 16:21:20.568477 | 18512d63-342f-4fc4-ba99-523c69b6c5df ==============================
[0m16:21:20.568477 [info ] [MainThread]: Running with dbt=1.10.15
[0m16:21:20.568695 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'fail_fast': 'False', 'introspect': 'True', 'log_path': '/Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_spotrac_dead_money --profiles-dir .', 'no_print': 'None', 'target_path': 'None', 'printer_width': '80', 'cache_selected_only': 'False', 'write_json': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'quiet': 'False', 'empty': 'False', 'partial_parse': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '.', 'log_cache_events': 'False'}
[0m16:21:20.642076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18512d63-342f-4fc4-ba99-523c69b6c5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125b10f0>]}
[0m16:21:20.660855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18512d63-342f-4fc4-ba99-523c69b6c5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113795ae0>]}
[0m16:21:20.661705 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:21:20.699149 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m16:21:20.749800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:21:20.750085 [debug] [MainThread]: Partial parsing: updated file: nfl_dead_money://models/staging/stg_spotrac_dead_money.sql
[0m16:21:20.835365 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.nfl_dead_money.spotrac_team_cap
[0m16:21:20.839773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18512d63-342f-4fc4-ba99-523c69b6c5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e88950>]}
[0m16:21:20.881522 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/manifest.json
[0m16:21:20.882796 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/semantic_manifest.json
[0m16:21:20.944953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18512d63-342f-4fc4-ba99-523c69b6c5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c28f50>]}
[0m16:21:20.945199 [info ] [MainThread]: Found 10 models, 1 seed, 2 operations, 34 data tests, 4 sources, 469 macros
[0m16:21:20.945322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18512d63-342f-4fc4-ba99-523c69b6c5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c81550>]}
[0m16:21:20.946081 [info ] [MainThread]: 
[0m16:21:20.946191 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:21:20.946275 [info ] [MainThread]: 
[0m16:21:20.946438 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:21:20.946777 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfl_dead_money'
[0m16:21:20.963540 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money"
[0m16:21:20.963731 [debug] [ThreadPool]: On list_nfl_dead_money: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nfl_dead_money"'
    
  
  
[0m16:21:20.963836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:20.969872 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:21:20.970415 [debug] [ThreadPool]: On list_nfl_dead_money: Close
[0m16:21:20.970681 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfl_dead_money, now create_nfl_dead_money_main_staging)
[0m16:21:20.970841 [debug] [ThreadPool]: Creating schema "database: "nfl_dead_money"
schema: "main_staging"
"
[0m16:21:20.973092 [debug] [ThreadPool]: Using duckdb connection "create_nfl_dead_money_main_staging"
[0m16:21:20.973217 [debug] [ThreadPool]: On create_nfl_dead_money_main_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "create_nfl_dead_money_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nfl_dead_money'
        and type='sqlite'
    
  
[0m16:21:20.973309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:20.973656 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:21:20.974292 [debug] [ThreadPool]: Using duckdb connection "create_nfl_dead_money_main_staging"
[0m16:21:20.974459 [debug] [ThreadPool]: On create_nfl_dead_money_main_staging: BEGIN
[0m16:21:20.974674 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:21:20.974757 [debug] [ThreadPool]: Using duckdb connection "create_nfl_dead_money_main_staging"
[0m16:21:20.974842 [debug] [ThreadPool]: On create_nfl_dead_money_main_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "create_nfl_dead_money_main_staging"} */

    
    
        create schema if not exists "nfl_dead_money"."main_staging"
    
[0m16:21:20.975022 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:21:20.975278 [debug] [ThreadPool]: On create_nfl_dead_money_main_staging: COMMIT
[0m16:21:20.975373 [debug] [ThreadPool]: Using duckdb connection "create_nfl_dead_money_main_staging"
[0m16:21:20.975448 [debug] [ThreadPool]: On create_nfl_dead_money_main_staging: COMMIT
[0m16:21:20.975589 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:21:20.975669 [debug] [ThreadPool]: On create_nfl_dead_money_main_staging: Close
[0m16:21:20.977651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nfl_dead_money_main_staging, now list_nfl_dead_money_main_staging)
[0m16:21:20.977871 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfl_dead_money_main'
[0m16:21:20.979905 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_staging"
[0m16:21:20.980085 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfl_dead_money_main_marts'
[0m16:21:20.980251 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfl_dead_money_main_intermediate'
[0m16:21:20.980735 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main"
[0m16:21:20.980878 [debug] [ThreadPool]: On list_nfl_dead_money_main_staging: BEGIN
[0m16:21:20.981413 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_marts"
[0m16:21:20.982093 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_intermediate"
[0m16:21:20.982207 [debug] [ThreadPool]: On list_nfl_dead_money_main: BEGIN
[0m16:21:20.982299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:20.982384 [debug] [ThreadPool]: On list_nfl_dead_money_main_marts: BEGIN
[0m16:21:20.982465 [debug] [ThreadPool]: On list_nfl_dead_money_main_intermediate: BEGIN
[0m16:21:20.982545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:20.982712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:20.982824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:20.982986 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:21:20.983182 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:21:20.983299 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_staging"
[0m16:21:20.983397 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:21:20.983473 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:21:20.983551 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main"
[0m16:21:20.983641 [debug] [ThreadPool]: On list_nfl_dead_money_main_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money_main_staging"} */
select
      'nfl_dead_money' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'nfl_dead_money'
  
[0m16:21:20.983729 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_marts"
[0m16:21:20.983808 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_intermediate"
[0m16:21:20.983895 [debug] [ThreadPool]: On list_nfl_dead_money_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money_main"} */
select
      'nfl_dead_money' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'nfl_dead_money'
  
[0m16:21:20.984060 [debug] [ThreadPool]: On list_nfl_dead_money_main_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money_main_marts"} */
select
      'nfl_dead_money' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'nfl_dead_money'
  
[0m16:21:20.984177 [debug] [ThreadPool]: On list_nfl_dead_money_main_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money_main_intermediate"} */
select
      'nfl_dead_money' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'nfl_dead_money'
  
[0m16:21:20.989390 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:21:20.989584 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:21:20.989723 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:21:20.990125 [debug] [ThreadPool]: On list_nfl_dead_money_main_intermediate: ROLLBACK
[0m16:21:20.990256 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:21:20.990682 [debug] [ThreadPool]: On list_nfl_dead_money_main: ROLLBACK
[0m16:21:20.991069 [debug] [ThreadPool]: On list_nfl_dead_money_main_marts: ROLLBACK
[0m16:21:20.991529 [debug] [ThreadPool]: On list_nfl_dead_money_main_staging: ROLLBACK
[0m16:21:20.992063 [debug] [ThreadPool]: Failed to rollback 'list_nfl_dead_money_main_intermediate'
[0m16:21:20.992255 [debug] [ThreadPool]: Failed to rollback 'list_nfl_dead_money_main'
[0m16:21:20.992459 [debug] [ThreadPool]: Failed to rollback 'list_nfl_dead_money_main_marts'
[0m16:21:20.992593 [debug] [ThreadPool]: On list_nfl_dead_money_main_intermediate: Close
[0m16:21:20.992731 [debug] [ThreadPool]: On list_nfl_dead_money_main: Close
[0m16:21:20.992878 [debug] [ThreadPool]: On list_nfl_dead_money_main_marts: Close
[0m16:21:20.993036 [debug] [ThreadPool]: Failed to rollback 'list_nfl_dead_money_main_staging'
[0m16:21:20.993313 [debug] [ThreadPool]: On list_nfl_dead_money_main_staging: Close
[0m16:21:20.993729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18512d63-342f-4fc4-ba99-523c69b6c5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1168c5f30>]}
[0m16:21:20.993895 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:20.993985 [debug] [MainThread]: On master: BEGIN
[0m16:21:20.994063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:21:20.994269 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:21:20.994348 [debug] [MainThread]: On master: COMMIT
[0m16:21:20.994426 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:20.994499 [debug] [MainThread]: On master: COMMIT
[0m16:21:20.994634 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:21:20.997031 [info ] [MainThread]: Starting dbt run for NFL dead money data pipeline
[0m16:21:20.997166 [debug] [MainThread]: Writing injected SQL for node "operation.nfl_dead_money.nfl_dead_money-on-run-start-0"
[0m16:21:20.998609 [info ] [MainThread]: 1 of 1 START hook: nfl_dead_money.on-run-start.0 ............................... [RUN]
[0m16:21:20.998762 [info ] [MainThread]: 1 of 1 OK hook: nfl_dead_money.on-run-start.0 .................................. [[32mOK[0m in 0.00s]
[0m16:21:20.998856 [info ] [MainThread]: 
[0m16:21:20.998950 [debug] [MainThread]: On master: Close
[0m16:21:20.999744 [debug] [Thread-1 (]: Began running node model.nfl_dead_money.stg_spotrac_dead_money
[0m16:21:20.999911 [info ] [Thread-1 (]: 1 of 1 START sql table model main_staging.stg_spotrac_dead_money ............... [RUN]
[0m16:21:21.000290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nfl_dead_money_main_staging, now model.nfl_dead_money.stg_spotrac_dead_money)
[0m16:21:21.000403 [debug] [Thread-1 (]: Began compiling node model.nfl_dead_money.stg_spotrac_dead_money
[0m16:21:21.001338 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfl_dead_money.stg_spotrac_dead_money"
[0m16:21:21.001644 [debug] [Thread-1 (]: Began executing node model.nfl_dead_money.stg_spotrac_dead_money
[0m16:21:21.011505 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfl_dead_money.stg_spotrac_dead_money"
[0m16:21:21.011824 [debug] [Thread-1 (]: Using duckdb connection "model.nfl_dead_money.stg_spotrac_dead_money"
[0m16:21:21.011957 [debug] [Thread-1 (]: On model.nfl_dead_money.stg_spotrac_dead_money: BEGIN
[0m16:21:21.012081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:21.012337 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:21:21.012445 [debug] [Thread-1 (]: Using duckdb connection "model.nfl_dead_money.stg_spotrac_dead_money"
[0m16:21:21.012558 [debug] [Thread-1 (]: On model.nfl_dead_money.stg_spotrac_dead_money: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "node_id": "model.nfl_dead_money.stg_spotrac_dead_money"} */

  
    
    

    create  table
      "nfl_dead_money"."main_staging"."stg_spotrac_dead_money__dbt_tmp"
  
    as (
      

-- Stage raw Spotrac player dead money data
-- Source: data/staging/stg_spotrac_dead_money.csv (from ingestion layer)
-- Cleans column names, casts to correct types, applies light validation

-- For development: source from staging CSV directly
-- In production, would source from database table
select
  player_name,
  team,
  cast(year as integer) as year,
  cast(dead_cap_hit as decimal(10, 2)) as dead_cap_millions,
  position,
  is_king
from "nfl_dead_money"."main"."spotrac_dead_money"
where dead_cap_hit > 0
order by year, team, dead_cap_hit desc
    );
  
  
[0m16:21:21.013910 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:21:21.015943 [debug] [Thread-1 (]: Using duckdb connection "model.nfl_dead_money.stg_spotrac_dead_money"
[0m16:21:21.016084 [debug] [Thread-1 (]: On model.nfl_dead_money.stg_spotrac_dead_money: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "node_id": "model.nfl_dead_money.stg_spotrac_dead_money"} */
alter table "nfl_dead_money"."main_staging"."stg_spotrac_dead_money__dbt_tmp" rename to "stg_spotrac_dead_money"
[0m16:21:21.016364 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:21:21.020641 [debug] [Thread-1 (]: On model.nfl_dead_money.stg_spotrac_dead_money: COMMIT
[0m16:21:21.020770 [debug] [Thread-1 (]: Using duckdb connection "model.nfl_dead_money.stg_spotrac_dead_money"
[0m16:21:21.020867 [debug] [Thread-1 (]: On model.nfl_dead_money.stg_spotrac_dead_money: COMMIT
[0m16:21:21.021448 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:21:21.023302 [debug] [Thread-1 (]: Using duckdb connection "model.nfl_dead_money.stg_spotrac_dead_money"
[0m16:21:21.023433 [debug] [Thread-1 (]: On model.nfl_dead_money.stg_spotrac_dead_money: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "node_id": "model.nfl_dead_money.stg_spotrac_dead_money"} */

      drop table if exists "nfl_dead_money"."main_staging"."stg_spotrac_dead_money__dbt_backup" cascade
    
[0m16:21:21.023669 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:21:21.024482 [debug] [Thread-1 (]: On model.nfl_dead_money.stg_spotrac_dead_money: Close
[0m16:21:21.025058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18512d63-342f-4fc4-ba99-523c69b6c5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1169d10d0>]}
[0m16:21:21.025271 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_staging.stg_spotrac_dead_money .......... [[32mOK[0m in 0.02s]
[0m16:21:21.025446 [debug] [Thread-1 (]: Finished running node model.nfl_dead_money.stg_spotrac_dead_money
[0m16:21:21.025959 [info ] [MainThread]: 
[0m16:21:21.026084 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:21.026173 [debug] [MainThread]: On master: BEGIN
[0m16:21:21.026253 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:21:21.026431 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:21:21.026517 [debug] [MainThread]: On master: COMMIT
[0m16:21:21.026607 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:21.026682 [debug] [MainThread]: On master: COMMIT
[0m16:21:21.026813 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:21:21.027580 [info ] [MainThread]: Completed dbt run
[0m16:21:21.027704 [debug] [MainThread]: Writing injected SQL for node "operation.nfl_dead_money.nfl_dead_money-on-run-end-0"
[0m16:21:21.027888 [info ] [MainThread]: 1 of 1 START hook: nfl_dead_money.on-run-end.0 ................................. [RUN]
[0m16:21:21.028029 [info ] [MainThread]: 1 of 1 OK hook: nfl_dead_money.on-run-end.0 .................................... [[32mOK[0m in 0.00s]
[0m16:21:21.028121 [debug] [MainThread]: On master: Close
[0m16:21:21.028226 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:21:21.028300 [debug] [MainThread]: Connection 'model.nfl_dead_money.stg_spotrac_dead_money' was properly closed.
[0m16:21:21.028366 [debug] [MainThread]: Connection 'list_nfl_dead_money_main' was properly closed.
[0m16:21:21.028432 [debug] [MainThread]: Connection 'list_nfl_dead_money_main_marts' was properly closed.
[0m16:21:21.028494 [debug] [MainThread]: Connection 'list_nfl_dead_money_main_intermediate' was properly closed.
[0m16:21:21.028590 [info ] [MainThread]: 
[0m16:21:21.028682 [info ] [MainThread]: Finished running 2 project hooks, 1 table model in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m16:21:21.028942 [debug] [MainThread]: Command end result
[0m16:21:21.038942 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/manifest.json
[0m16:21:21.039672 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/semantic_manifest.json
[0m16:21:21.041785 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/run_results.json
[0m16:21:21.041900 [info ] [MainThread]: 
[0m16:21:21.042030 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:21:21.042133 [info ] [MainThread]: 
[0m16:21:21.042242 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m16:21:21.043285 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5021178, "process_in_blocks": "0", "process_kernel_time": 0.1196, "process_mem_max_rss": "174260224", "process_out_blocks": "0", "process_user_time": 1.223791}
[0m16:21:21.043443 [debug] [MainThread]: Command `dbt run` succeeded at 16:21:21.043412 after 0.50 seconds
[0m16:21:21.043565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11554be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ba2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b7de50>]}
[0m16:21:21.043698 [debug] [MainThread]: Flushing usage events
[0m16:21:21.483673 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:21:27.982776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062bbb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121967c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121967ed0>]}


============================== 16:21:27.984532 | 5d061385-6651-400c-8adc-c23e8399c2ce ==============================
[0m16:21:27.984532 [info ] [MainThread]: Running with dbt=1.10.15
[0m16:21:27.984745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'profiles_dir': '.', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select marts --profiles-dir .', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'log_cache_events': 'False', 'log_path': '/Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/logs', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'write_json': 'True', 'partial_parse': 'True', 'debug': 'False', 'use_colors': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None'}
[0m16:21:28.058068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d061385-6651-400c-8adc-c23e8399c2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1200b50f0>]}
[0m16:21:28.077076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d061385-6651-400c-8adc-c23e8399c2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121a95ae0>]}
[0m16:21:28.077925 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:21:28.115542 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m16:21:28.165064 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:21:28.165242 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:21:28.167480 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.nfl_dead_money.spotrac_team_cap
[0m16:21:28.186848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d061385-6651-400c-8adc-c23e8399c2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1220b2e50>]}
[0m16:21:28.223984 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/manifest.json
[0m16:21:28.224800 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/semantic_manifest.json
[0m16:21:28.230743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d061385-6651-400c-8adc-c23e8399c2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e29220>]}
[0m16:21:28.230919 [info ] [MainThread]: Found 10 models, 1 seed, 2 operations, 34 data tests, 4 sources, 469 macros
[0m16:21:28.231027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d061385-6651-400c-8adc-c23e8399c2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1223a20b0>]}
[0m16:21:28.231781 [info ] [MainThread]: 
[0m16:21:28.231898 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:21:28.231978 [info ] [MainThread]: 
[0m16:21:28.232144 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:21:28.233801 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfl_dead_money'
[0m16:21:28.249880 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money"
[0m16:21:28.250037 [debug] [ThreadPool]: On list_nfl_dead_money: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nfl_dead_money"'
    
  
  
[0m16:21:28.250135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:28.255776 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:21:28.256274 [debug] [ThreadPool]: On list_nfl_dead_money: Close
[0m16:21:28.256523 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfl_dead_money, now create_nfl_dead_money_main_marts)
[0m16:21:28.256670 [debug] [ThreadPool]: Creating schema "database: "nfl_dead_money"
schema: "main_marts"
"
[0m16:21:28.258782 [debug] [ThreadPool]: Using duckdb connection "create_nfl_dead_money_main_marts"
[0m16:21:28.258888 [debug] [ThreadPool]: On create_nfl_dead_money_main_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "create_nfl_dead_money_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nfl_dead_money'
        and type='sqlite'
    
  
[0m16:21:28.258971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:28.259253 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:21:28.259652 [debug] [ThreadPool]: Using duckdb connection "create_nfl_dead_money_main_marts"
[0m16:21:28.259736 [debug] [ThreadPool]: On create_nfl_dead_money_main_marts: BEGIN
[0m16:21:28.259889 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:21:28.259983 [debug] [ThreadPool]: Using duckdb connection "create_nfl_dead_money_main_marts"
[0m16:21:28.260064 [debug] [ThreadPool]: On create_nfl_dead_money_main_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "create_nfl_dead_money_main_marts"} */

    
    
        create schema if not exists "nfl_dead_money"."main_marts"
    
[0m16:21:28.260238 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:21:28.260516 [debug] [ThreadPool]: On create_nfl_dead_money_main_marts: COMMIT
[0m16:21:28.260606 [debug] [ThreadPool]: Using duckdb connection "create_nfl_dead_money_main_marts"
[0m16:21:28.260684 [debug] [ThreadPool]: On create_nfl_dead_money_main_marts: COMMIT
[0m16:21:28.261071 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:21:28.261197 [debug] [ThreadPool]: On create_nfl_dead_money_main_marts: Close
[0m16:21:28.261779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nfl_dead_money_main_marts, now list_nfl_dead_money_main)
[0m16:21:28.263784 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main"
[0m16:21:28.263968 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfl_dead_money_main_staging'
[0m16:21:28.264093 [debug] [ThreadPool]: On list_nfl_dead_money_main: BEGIN
[0m16:21:28.264273 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfl_dead_money_main_intermediate'
[0m16:21:28.264461 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfl_dead_money_main_marts'
[0m16:21:28.264980 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_staging"
[0m16:21:28.265103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:28.265574 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_intermediate"
[0m16:21:28.266147 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_marts"
[0m16:21:28.266246 [debug] [ThreadPool]: On list_nfl_dead_money_main_staging: BEGIN
[0m16:21:28.266421 [debug] [ThreadPool]: On list_nfl_dead_money_main_intermediate: BEGIN
[0m16:21:28.266523 [debug] [ThreadPool]: On list_nfl_dead_money_main_marts: BEGIN
[0m16:21:28.266635 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:21:28.266728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:28.266818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:28.266912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:28.267006 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main"
[0m16:21:28.267249 [debug] [ThreadPool]: On list_nfl_dead_money_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money_main"} */
select
      'nfl_dead_money' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'nfl_dead_money'
  
[0m16:21:28.267355 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:21:28.267519 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:21:28.267641 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_staging"
[0m16:21:28.267729 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:21:28.267821 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_intermediate"
[0m16:21:28.267921 [debug] [ThreadPool]: On list_nfl_dead_money_main_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money_main_staging"} */
select
      'nfl_dead_money' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'nfl_dead_money'
  
[0m16:21:28.268020 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_marts"
[0m16:21:28.268118 [debug] [ThreadPool]: On list_nfl_dead_money_main_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money_main_intermediate"} */
select
      'nfl_dead_money' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'nfl_dead_money'
  
[0m16:21:28.268274 [debug] [ThreadPool]: On list_nfl_dead_money_main_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money_main_marts"} */
select
      'nfl_dead_money' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'nfl_dead_money'
  
[0m16:21:28.273103 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:21:28.273316 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:21:28.273446 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:21:28.273858 [debug] [ThreadPool]: On list_nfl_dead_money_main_intermediate: ROLLBACK
[0m16:21:28.273987 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:21:28.274347 [debug] [ThreadPool]: On list_nfl_dead_money_main: ROLLBACK
[0m16:21:28.274747 [debug] [ThreadPool]: On list_nfl_dead_money_main_staging: ROLLBACK
[0m16:21:28.275122 [debug] [ThreadPool]: On list_nfl_dead_money_main_marts: ROLLBACK
[0m16:21:28.275575 [debug] [ThreadPool]: Failed to rollback 'list_nfl_dead_money_main_intermediate'
[0m16:21:28.275711 [debug] [ThreadPool]: On list_nfl_dead_money_main_intermediate: Close
[0m16:21:28.275930 [debug] [ThreadPool]: Failed to rollback 'list_nfl_dead_money_main_marts'
[0m16:21:28.276054 [debug] [ThreadPool]: On list_nfl_dead_money_main_marts: Close
[0m16:21:28.276326 [debug] [ThreadPool]: Failed to rollback 'list_nfl_dead_money_main'
[0m16:21:28.276463 [debug] [ThreadPool]: On list_nfl_dead_money_main: Close
[0m16:21:28.276632 [debug] [ThreadPool]: Failed to rollback 'list_nfl_dead_money_main_staging'
[0m16:21:28.276910 [debug] [ThreadPool]: On list_nfl_dead_money_main_staging: Close
[0m16:21:28.277217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d061385-6651-400c-8adc-c23e8399c2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1225f6c30>]}
[0m16:21:28.277370 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:28.277453 [debug] [MainThread]: On master: BEGIN
[0m16:21:28.277537 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:21:28.277718 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:21:28.277798 [debug] [MainThread]: On master: COMMIT
[0m16:21:28.277872 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:28.277945 [debug] [MainThread]: On master: COMMIT
[0m16:21:28.278077 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:21:28.280416 [info ] [MainThread]: Starting dbt run for NFL dead money data pipeline
[0m16:21:28.280547 [debug] [MainThread]: Writing injected SQL for node "operation.nfl_dead_money.nfl_dead_money-on-run-start-0"
[0m16:21:28.282005 [info ] [MainThread]: 1 of 1 START hook: nfl_dead_money.on-run-start.0 ............................... [RUN]
[0m16:21:28.282178 [info ] [MainThread]: 1 of 1 OK hook: nfl_dead_money.on-run-start.0 .................................. [[32mOK[0m in 0.00s]
[0m16:21:28.282276 [info ] [MainThread]: 
[0m16:21:28.282549 [debug] [MainThread]: On master: Close
[0m16:21:28.283531 [debug] [Thread-2 (]: Began running node model.nfl_dead_money.fct_dead_money_by_player
[0m16:21:28.283676 [debug] [Thread-4 (]: Began running node model.nfl_dead_money.fct_dead_money_events
[0m16:21:28.283791 [debug] [Thread-3 (]: Began running node model.nfl_dead_money.fct_dead_money_by_year
[0m16:21:28.283890 [debug] [Thread-1 (]: Began running node model.nfl_dead_money.dim_teams
[0m16:21:28.284048 [info ] [Thread-2 (]: 2 of 5 START sql table model main_marts.fct_dead_money_by_player ............... [RUN]
[0m16:21:28.284215 [info ] [Thread-4 (]: 4 of 5 START sql table model main_marts.fct_dead_money_events .................. [RUN]
[0m16:21:28.284375 [info ] [Thread-3 (]: 3 of 5 START sql table model main_marts.fct_dead_money_by_year ................. [RUN]
[0m16:21:28.284514 [info ] [Thread-1 (]: 1 of 5 START sql table model main_marts.dim_teams .............................. [RUN]
[0m16:21:28.284667 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_nfl_dead_money_main_staging, now model.nfl_dead_money.fct_dead_money_by_player)
[0m16:21:28.284784 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_nfl_dead_money_main_marts, now model.nfl_dead_money.fct_dead_money_events)
[0m16:21:28.284898 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_nfl_dead_money_main_intermediate, now model.nfl_dead_money.fct_dead_money_by_year)
[0m16:21:28.285006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nfl_dead_money_main, now model.nfl_dead_money.dim_teams)
[0m16:21:28.285120 [debug] [Thread-2 (]: Began compiling node model.nfl_dead_money.fct_dead_money_by_player
[0m16:21:28.285225 [debug] [Thread-4 (]: Began compiling node model.nfl_dead_money.fct_dead_money_events
[0m16:21:28.285328 [debug] [Thread-3 (]: Began compiling node model.nfl_dead_money.fct_dead_money_by_year
[0m16:21:28.285419 [debug] [Thread-1 (]: Began compiling node model.nfl_dead_money.dim_teams
[0m16:21:28.286717 [debug] [Thread-2 (]: Writing injected SQL for node "model.nfl_dead_money.fct_dead_money_by_player"
[0m16:21:28.288528 [debug] [Thread-3 (]: Writing injected SQL for node "model.nfl_dead_money.fct_dead_money_by_year"
[0m16:21:28.289542 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfl_dead_money.dim_teams"
[0m16:21:28.289954 [debug] [Thread-2 (]: Began executing node model.nfl_dead_money.fct_dead_money_by_player
[0m16:21:28.290083 [debug] [Thread-1 (]: Began executing node model.nfl_dead_money.dim_teams
[0m16:21:28.296910 [debug] [Thread-3 (]: Began executing node model.nfl_dead_money.fct_dead_money_by_year
[0m16:21:28.300443 [debug] [Thread-2 (]: Writing runtime sql for node "model.nfl_dead_money.fct_dead_money_by_player"
[0m16:21:28.301247 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfl_dead_money.dim_teams"
[0m16:21:28.303685 [debug] [Thread-3 (]: Writing runtime sql for node "model.nfl_dead_money.fct_dead_money_by_year"
[0m16:21:28.304242 [debug] [Thread-3 (]: Using duckdb connection "model.nfl_dead_money.fct_dead_money_by_year"
[0m16:21:28.304373 [debug] [Thread-1 (]: Using duckdb connection "model.nfl_dead_money.dim_teams"
[0m16:21:28.304500 [debug] [Thread-3 (]: On model.nfl_dead_money.fct_dead_money_by_year: BEGIN
[0m16:21:28.304634 [debug] [Thread-2 (]: Using duckdb connection "model.nfl_dead_money.fct_dead_money_by_player"
[0m16:21:28.304829 [debug] [Thread-1 (]: On model.nfl_dead_money.dim_teams: BEGIN
[0m16:21:28.304943 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:21:28.305170 [debug] [Thread-2 (]: On model.nfl_dead_money.fct_dead_money_by_player: BEGIN
[0m16:21:28.305294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:28.305540 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:21:28.305710 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:21:28.305930 [debug] [Thread-3 (]: Using duckdb connection "model.nfl_dead_money.fct_dead_money_by_year"
[0m16:21:28.306061 [debug] [Thread-3 (]: On model.nfl_dead_money.fct_dead_money_by_year: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "node_id": "model.nfl_dead_money.fct_dead_money_by_year"} */

  
    
    

    create  table
      "nfl_dead_money"."main_marts"."fct_dead_money_by_year__dbt_tmp"
  
    as (
      

-- Dead money by team and year: for team-level heatmap/line chart
with team_cap as (
  select
    year,
    team,
    team_name,
    dead_money_millions,
    salary_cap_millions,
    (case when salary_cap_millions > 0 
      then round((dead_money_millions / salary_cap_millions * 100)::numeric, 2)
      else 0 end) as dead_cap_pct
  from "nfl_dead_money"."main_staging"."stg_spotrac_team_cap"
)

select
  year,
  team,
  team_name,
  round(dead_money_millions::numeric, 2) as dead_money_millions,
  round(salary_cap_millions::numeric, 2) as salary_cap_millions,
  dead_cap_pct,
  row_number() over (partition by year order by dead_money_millions desc) as rank_in_year
from team_cap
order by year, rank_in_year
    );
  
  
[0m16:21:28.306342 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:21:28.306474 [debug] [Thread-1 (]: Using duckdb connection "model.nfl_dead_money.dim_teams"
[0m16:21:28.306588 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:21:28.306711 [debug] [Thread-1 (]: On model.nfl_dead_money.dim_teams: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "node_id": "model.nfl_dead_money.dim_teams"} */

  
    
    

    create  table
      "nfl_dead_money"."main_marts"."dim_teams__dbt_tmp"
  
    as (
      -- [TODO: PRODUCTIONIZATION - PHASE 2]
-- Mart model: Dimension table - Teams



with teams as (
    select distinct team as team_code, team_name
    from "nfl_dead_money"."main_staging"."stg_spotrac_team_cap"
)

select team_code as team,
             team_name,
             CURRENT_TIMESTAMP() as dbt_created_at
from teams
order by team_code
    );
  
  
[0m16:21:28.306907 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "node_id": "model.nfl_dead_money.fct_dead_money_by_year"} */

  
    
    

    create  table
      "nfl_dead_money"."main_marts"."fct_dead_money_by_year__dbt_tmp"
  
    as (
      

-- Dead money by team and year: for team-level heatmap/line chart
with team_cap as (
  select
    year,
    team,
    team_name,
    dead_money_millions,
    salary_cap_millions,
    (case when salary_cap_millions > 0 
      then round((dead_money_millions / salary_cap_millions * 100)::numeric, 2)
      else 0 end) as dead_cap_pct
  from "nfl_dead_money"."main_staging"."stg_spotrac_team_cap"
)

select
  year,
  team,
  team_name,
  round(dead_money_millions::numeric, 2) as dead_money_millions,
  round(salary_cap_millions::numeric, 2) as salary_cap_millions,
  dead_cap_pct,
  row_number() over (partition by year order by dead_money_millions desc) as rank_in_year
from team_cap
order by year, rank_in_year
    );
  
  
[0m16:21:28.307079 [debug] [Thread-2 (]: Using duckdb connection "model.nfl_dead_money.fct_dead_money_by_player"
[0m16:21:28.307711 [debug] [Thread-4 (]: Compilation Error in model fct_dead_money_events (models/marts/fct_dead_money_events.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:21:28.307917 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m16:21:28.308080 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "node_id": "model.nfl_dead_money.dim_teams"} */

  
    
    

    create  table
      "nfl_dead_money"."main_marts"."dim_teams__dbt_tmp"
  
    as (
      -- [TODO: PRODUCTIONIZATION - PHASE 2]
-- Mart model: Dimension table - Teams



with teams as (
    select distinct team as team_code, team_name
    from "nfl_dead_money"."main_staging"."stg_spotrac_team_cap"
)

select team_code as team,
             team_name,
             CURRENT_TIMESTAMP() as dbt_created_at
from teams
order by team_code
    );
  
  
[0m16:21:28.308246 [debug] [Thread-2 (]: On model.nfl_dead_money.fct_dead_money_by_player: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "node_id": "model.nfl_dead_money.fct_dead_money_by_player"} */

  
    
    

    create  table
      "nfl_dead_money"."main_marts"."fct_dead_money_by_player__dbt_tmp"
  
    as (
      

-- Dead money by player: for player-level analysis with percentile ranks
-- Filter: only include players with > $1M dead cap (avoid noise from minor charges)
with player_dm as (
  select
    player_name,
    team,
    year,
    dead_cap_millions
  from "nfl_dead_money"."main_staging"."stg_spotrac_dead_money"
  where dead_cap_millions > 1.0
),

team_totals as (
  select
    team,
    year,
    sum(dead_cap_millions) as team_total_dead_money_millions
  from player_dm
  group by team, year
),

nfl_stats as (
  select
    year,
    sum(dead_cap_millions) as nfl_total_dead_money_millions,
    avg(dead_cap_millions) as nfl_avg_dead_cap,
    stddev_pop(dead_cap_millions) as nfl_stddev_dead_cap,
    percentile_cont(0.75) within group (order by dead_cap_millions) as p75_dead_cap,
    percentile_cont(0.90) within group (order by dead_cap_millions) as p90_dead_cap,
    percentile_cont(0.95) within group (order by dead_cap_millions) as p95_dead_cap
  from player_dm
  group by year
),

player_with_percentile as (
  select
    p.player_name,
    p.team,
    p.year,
    p.dead_cap_millions,
    t.team_total_dead_money_millions,
    round((p.dead_cap_millions / t.team_total_dead_money_millions * 100)::numeric, 2) as pct_of_team_dead_money,
    n.nfl_total_dead_money_millions,
    round((p.dead_cap_millions / n.nfl_total_dead_money_millions * 100)::numeric, 4) as pct_of_nfl_dead_money,
    percent_rank() over (partition by p.year order by p.dead_cap_millions) as percentile_rank,
    round((percent_rank() over (partition by p.year order by p.dead_cap_millions) * 100)::numeric, 1) as nfl_percentile
  from player_dm p
  join team_totals t on p.team = t.team and p.year = t.year
  join nfl_stats n on p.year = n.year
)

select
  player_name,
  team,
  year,
  round(dead_cap_millions::numeric, 2) as dead_cap_millions,
  round(team_total_dead_money_millions::numeric, 2) as team_total_dead_money_millions,
  pct_of_team_dead_money,
  round(nfl_total_dead_money_millions::numeric, 2) as nfl_total_dead_money_millions,
  pct_of_nfl_dead_money,
  nfl_percentile,
  row_number() over (partition by year order by dead_cap_millions desc) as rank_in_year
from player_with_percentile
order by year, dead_cap_millions desc
    );
  
  
[0m16:21:28.308902 [debug] [Thread-3 (]: On model.nfl_dead_money.fct_dead_money_by_year: ROLLBACK
[0m16:21:28.309052 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:21:28.309742 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d061385-6651-400c-8adc-c23e8399c2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1223da8d0>]}
[0m16:21:28.309914 [debug] [Thread-1 (]: On model.nfl_dead_money.dim_teams: ROLLBACK
[0m16:21:28.310154 [error] [Thread-4 (]: 4 of 5 ERROR creating sql table model main_marts.fct_dead_money_events ......... [[31mERROR[0m in 0.02s]
[0m16:21:28.310732 [debug] [Thread-4 (]: Finished running node model.nfl_dead_money.fct_dead_money_events
[0m16:21:28.311213 [debug] [Thread-4 (]: Began running node model.nfl_dead_money.fct_dead_money_trend
[0m16:21:28.311391 [info ] [Thread-4 (]: 5 of 5 START sql table model main_marts.fct_dead_money_trend ................... [RUN]
[0m16:21:28.311619 [debug] [Thread-7 (]: Marking all children of 'model.nfl_dead_money.fct_dead_money_events' to be skipped because of status 'error'.  Reason: Compilation Error in model fct_dead_money_events (models/marts/fct_dead_money_events.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m16:21:28.311772 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nfl_dead_money.fct_dead_money_events, now model.nfl_dead_money.fct_dead_money_trend)
[0m16:21:28.312642 [debug] [Thread-4 (]: Began compiling node model.nfl_dead_money.fct_dead_money_trend
[0m16:21:28.314033 [debug] [Thread-4 (]: Writing injected SQL for node "model.nfl_dead_money.fct_dead_money_trend"
[0m16:21:28.314734 [debug] [Thread-4 (]: Began executing node model.nfl_dead_money.fct_dead_money_trend
[0m16:21:28.362209 [debug] [Thread-4 (]: Writing runtime sql for node "model.nfl_dead_money.fct_dead_money_trend"
[0m16:21:28.362428 [debug] [Thread-2 (]: SQL status: OK in 0.053 seconds
[0m16:21:28.365087 [debug] [Thread-2 (]: Using duckdb connection "model.nfl_dead_money.fct_dead_money_by_player"
[0m16:21:28.366172 [debug] [Thread-3 (]: Failed to rollback 'model.nfl_dead_money.fct_dead_money_by_year'
[0m16:21:28.366333 [debug] [Thread-2 (]: On model.nfl_dead_money.fct_dead_money_by_player: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "node_id": "model.nfl_dead_money.fct_dead_money_by_player"} */
alter table "nfl_dead_money"."main_marts"."fct_dead_money_by_player__dbt_tmp" rename to "fct_dead_money_by_player"
[0m16:21:28.367283 [debug] [Thread-1 (]: Failed to rollback 'model.nfl_dead_money.dim_teams'
[0m16:21:28.367435 [debug] [Thread-4 (]: Using duckdb connection "model.nfl_dead_money.fct_dead_money_trend"
[0m16:21:28.367566 [debug] [Thread-3 (]: On model.nfl_dead_money.fct_dead_money_by_year: Close
[0m16:21:28.367772 [debug] [Thread-1 (]: On model.nfl_dead_money.dim_teams: Close
[0m16:21:28.367898 [debug] [Thread-4 (]: On model.nfl_dead_money.fct_dead_money_trend: BEGIN
[0m16:21:28.368047 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:21:28.368895 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:21:28.373149 [debug] [Thread-2 (]: On model.nfl_dead_money.fct_dead_money_by_player: COMMIT
[0m16:21:28.373424 [debug] [Thread-2 (]: Using duckdb connection "model.nfl_dead_money.fct_dead_money_by_player"
[0m16:21:28.373653 [debug] [Thread-2 (]: On model.nfl_dead_money.fct_dead_money_by_player: COMMIT
[0m16:21:28.373813 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m16:21:28.374001 [debug] [Thread-4 (]: Using duckdb connection "model.nfl_dead_money.fct_dead_money_trend"
[0m16:21:28.375004 [debug] [Thread-3 (]: Runtime Error in model fct_dead_money_by_year (models/marts/fct_dead_money_by_year.sql)
  Catalog Error: Table with name stg_spotrac_team_cap does not exist!
  Did you mean "stg_spotrac_dead_money"?
  
  LINE 24:   from "nfl_dead_money"."main_staging"."stg_spotrac_team_cap"
                  ^
[0m16:21:28.375140 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:21:28.375272 [debug] [Thread-4 (]: On model.nfl_dead_money.fct_dead_money_trend: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "node_id": "model.nfl_dead_money.fct_dead_money_trend"} */

  
    
    

    create  table
      "nfl_dead_money"."main_marts"."fct_dead_money_trend__dbt_tmp"
  
    as (
      

-- Dead money trend over time: total NFL dead money by year
with team_cap as (
  select
    year,
    team,
    dead_money_millions,
    salary_cap_millions
  from "nfl_dead_money"."main_staging"."stg_spotrac_team_cap"
)

select
  year,
  round(sum(dead_money_millions)::numeric, 2) as total_dead_money_millions,
  round(avg(dead_money_millions)::numeric, 2) as avg_dead_money_per_team,
  round(max(dead_money_millions)::numeric, 2) as max_dead_money_millions,
  count(distinct team) as teams_with_data
from team_cap
group by year
order by year
    );
  
  
[0m16:21:28.376194 [debug] [Thread-1 (]: Runtime Error in model dim_teams (models/marts/dim_teams.sql)
  Catalog Error: Table with name stg_spotrac_team_cap does not exist!
  Did you mean "stg_spotrac_dead_money"?
  
  LINE 18:     from "nfl_dead_money"."main_staging"."stg_spotrac_team_cap"
                    ^
[0m16:21:28.376389 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d061385-6651-400c-8adc-c23e8399c2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12246e830>]}
[0m16:21:28.378209 [debug] [Thread-2 (]: Using duckdb connection "model.nfl_dead_money.fct_dead_money_by_player"
[0m16:21:28.378447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d061385-6651-400c-8adc-c23e8399c2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122b13110>]}
[0m16:21:28.378826 [debug] [Thread-2 (]: On model.nfl_dead_money.fct_dead_money_by_player: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "node_id": "model.nfl_dead_money.fct_dead_money_by_player"} */

      drop table if exists "nfl_dead_money"."main_marts"."fct_dead_money_by_player__dbt_backup" cascade
    
[0m16:21:28.379000 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "node_id": "model.nfl_dead_money.fct_dead_money_trend"} */

  
    
    

    create  table
      "nfl_dead_money"."main_marts"."fct_dead_money_trend__dbt_tmp"
  
    as (
      

-- Dead money trend over time: total NFL dead money by year
with team_cap as (
  select
    year,
    team,
    dead_money_millions,
    salary_cap_millions
  from "nfl_dead_money"."main_staging"."stg_spotrac_team_cap"
)

select
  year,
  round(sum(dead_money_millions)::numeric, 2) as total_dead_money_millions,
  round(avg(dead_money_millions)::numeric, 2) as avg_dead_money_per_team,
  round(max(dead_money_millions)::numeric, 2) as max_dead_money_millions,
  count(distinct team) as teams_with_data
from team_cap
group by year
order by year
    );
  
  
[0m16:21:28.378711 [error] [Thread-3 (]: 3 of 5 ERROR creating sql table model main_marts.fct_dead_money_by_year ........ [[31mERROR[0m in 0.09s]
[0m16:21:28.379260 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model main_marts.dim_teams ..................... [[31mERROR[0m in 0.09s]
[0m16:21:28.379433 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m16:21:28.379613 [debug] [Thread-3 (]: Finished running node model.nfl_dead_money.fct_dead_money_by_year
[0m16:21:28.379728 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:21:28.379886 [debug] [Thread-1 (]: Finished running node model.nfl_dead_money.dim_teams
[0m16:21:28.380038 [debug] [Thread-4 (]: On model.nfl_dead_money.fct_dead_money_trend: ROLLBACK
[0m16:21:28.380209 [debug] [Thread-7 (]: Marking all children of 'model.nfl_dead_money.fct_dead_money_by_year' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_dead_money_by_year (models/marts/fct_dead_money_by_year.sql)
  Catalog Error: Table with name stg_spotrac_team_cap does not exist!
  Did you mean "stg_spotrac_dead_money"?
  
  LINE 24:   from "nfl_dead_money"."main_staging"."stg_spotrac_team_cap"
                  ^.
[0m16:21:28.381079 [debug] [Thread-2 (]: On model.nfl_dead_money.fct_dead_money_by_player: Close
[0m16:21:28.381318 [debug] [Thread-7 (]: Marking all children of 'model.nfl_dead_money.dim_teams' to be skipped because of status 'error'.  Reason: Runtime Error in model dim_teams (models/marts/dim_teams.sql)
  Catalog Error: Table with name stg_spotrac_team_cap does not exist!
  Did you mean "stg_spotrac_dead_money"?
  
  LINE 18:     from "nfl_dead_money"."main_staging"."stg_spotrac_team_cap"
                    ^.
[0m16:21:28.381858 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d061385-6651-400c-8adc-c23e8399c2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122bcb0d0>]}
[0m16:21:28.382081 [info ] [Thread-2 (]: 2 of 5 OK created sql table model main_marts.fct_dead_money_by_player .......... [[32mOK[0m in 0.10s]
[0m16:21:28.382274 [debug] [Thread-2 (]: Finished running node model.nfl_dead_money.fct_dead_money_by_player
[0m16:21:28.383510 [debug] [Thread-4 (]: Failed to rollback 'model.nfl_dead_money.fct_dead_money_trend'
[0m16:21:28.383630 [debug] [Thread-4 (]: On model.nfl_dead_money.fct_dead_money_trend: Close
[0m16:21:28.384868 [debug] [Thread-4 (]: Runtime Error in model fct_dead_money_trend (models/marts/fct_dead_money_trend.sql)
  Catalog Error: Table with name stg_spotrac_team_cap does not exist!
  Did you mean "stg_spotrac_dead_money"?
  
  LINE 20:   from "nfl_dead_money"."main_staging"."stg_spotrac_team_cap"
                  ^
[0m16:21:28.385001 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d061385-6651-400c-8adc-c23e8399c2ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e20de0>]}
[0m16:21:28.385183 [error] [Thread-4 (]: 5 of 5 ERROR creating sql table model main_marts.fct_dead_money_trend .......... [[31mERROR[0m in 0.07s]
[0m16:21:28.385349 [debug] [Thread-4 (]: Finished running node model.nfl_dead_money.fct_dead_money_trend
[0m16:21:28.385493 [debug] [Thread-7 (]: Marking all children of 'model.nfl_dead_money.fct_dead_money_trend' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_dead_money_trend (models/marts/fct_dead_money_trend.sql)
  Catalog Error: Table with name stg_spotrac_team_cap does not exist!
  Did you mean "stg_spotrac_dead_money"?
  
  LINE 20:   from "nfl_dead_money"."main_staging"."stg_spotrac_team_cap"
                  ^.
[0m16:21:28.386044 [info ] [MainThread]: 
[0m16:21:28.386172 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:28.386260 [debug] [MainThread]: On master: BEGIN
[0m16:21:28.386346 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:21:28.386513 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:21:28.386597 [debug] [MainThread]: On master: COMMIT
[0m16:21:28.386682 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:28.386761 [debug] [MainThread]: On master: COMMIT
[0m16:21:28.386928 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:21:28.387723 [info ] [MainThread]: Completed dbt run
[0m16:21:28.387847 [debug] [MainThread]: Writing injected SQL for node "operation.nfl_dead_money.nfl_dead_money-on-run-end-0"
[0m16:21:28.388025 [info ] [MainThread]: 1 of 1 START hook: nfl_dead_money.on-run-end.0 ................................. [RUN]
[0m16:21:28.388164 [info ] [MainThread]: 1 of 1 OK hook: nfl_dead_money.on-run-end.0 .................................... [[32mOK[0m in 0.00s]
[0m16:21:28.388263 [debug] [MainThread]: On master: Close
[0m16:21:28.388373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:21:28.388445 [debug] [MainThread]: Connection 'model.nfl_dead_money.dim_teams' was properly closed.
[0m16:21:28.388512 [debug] [MainThread]: Connection 'model.nfl_dead_money.fct_dead_money_by_player' was properly closed.
[0m16:21:28.388576 [debug] [MainThread]: Connection 'model.nfl_dead_money.fct_dead_money_by_year' was properly closed.
[0m16:21:28.388638 [debug] [MainThread]: Connection 'model.nfl_dead_money.fct_dead_money_trend' was properly closed.
[0m16:21:28.388734 [info ] [MainThread]: 
[0m16:21:28.388826 [info ] [MainThread]: Finished running 2 project hooks, 5 table models in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m16:21:28.389215 [debug] [MainThread]: Command end result
[0m16:21:28.399020 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/manifest.json
[0m16:21:28.399676 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/semantic_manifest.json
[0m16:21:28.401732 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/run_results.json
[0m16:21:28.401828 [info ] [MainThread]: 
[0m16:21:28.401935 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m16:21:28.402025 [info ] [MainThread]: 
[0m16:21:28.402138 [error] [MainThread]: [31mFailure in model fct_dead_money_events (models/marts/fct_dead_money_events.sql)[0m
[0m16:21:28.402244 [error] [MainThread]:   Compilation Error in model fct_dead_money_events (models/marts/fct_dead_money_events.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:21:28.402329 [info ] [MainThread]: 
[0m16:21:28.402431 [error] [MainThread]: [31mFailure in model fct_dead_money_by_year (models/marts/fct_dead_money_by_year.sql)[0m
[0m16:21:28.402533 [error] [MainThread]:   Runtime Error in model fct_dead_money_by_year (models/marts/fct_dead_money_by_year.sql)
  Catalog Error: Table with name stg_spotrac_team_cap does not exist!
  Did you mean "stg_spotrac_dead_money"?
  
  LINE 24:   from "nfl_dead_money"."main_staging"."stg_spotrac_team_cap"
                  ^
[0m16:21:28.402609 [info ] [MainThread]: 
[0m16:21:28.402701 [info ] [MainThread]:   compiled code at target/compiled/nfl_dead_money/models/marts/fct_dead_money_by_year.sql
[0m16:21:28.402777 [info ] [MainThread]: 
[0m16:21:28.402866 [error] [MainThread]: [31mFailure in model dim_teams (models/marts/dim_teams.sql)[0m
[0m16:21:28.402960 [error] [MainThread]:   Runtime Error in model dim_teams (models/marts/dim_teams.sql)
  Catalog Error: Table with name stg_spotrac_team_cap does not exist!
  Did you mean "stg_spotrac_dead_money"?
  
  LINE 18:     from "nfl_dead_money"."main_staging"."stg_spotrac_team_cap"
                    ^
[0m16:21:28.403034 [info ] [MainThread]: 
[0m16:21:28.403132 [info ] [MainThread]:   compiled code at target/compiled/nfl_dead_money/models/marts/dim_teams.sql
[0m16:21:28.403217 [info ] [MainThread]: 
[0m16:21:28.403356 [error] [MainThread]: [31mFailure in model fct_dead_money_trend (models/marts/fct_dead_money_trend.sql)[0m
[0m16:21:28.403478 [error] [MainThread]:   Runtime Error in model fct_dead_money_trend (models/marts/fct_dead_money_trend.sql)
  Catalog Error: Table with name stg_spotrac_team_cap does not exist!
  Did you mean "stg_spotrac_dead_money"?
  
  LINE 20:   from "nfl_dead_money"."main_staging"."stg_spotrac_team_cap"
                  ^
[0m16:21:28.403569 [info ] [MainThread]: 
[0m16:21:28.403669 [info ] [MainThread]:   compiled code at target/compiled/nfl_dead_money/models/marts/fct_dead_money_trend.sql
[0m16:21:28.403748 [info ] [MainThread]: 
[0m16:21:28.403838 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=4 SKIP=0 NO-OP=0 TOTAL=7
[0m16:21:28.404814 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.44572282, "process_in_blocks": "0", "process_kernel_time": 0.131009, "process_mem_max_rss": "194379776", "process_out_blocks": "0", "process_user_time": 1.180455}
[0m16:21:28.404970 [debug] [MainThread]: Command `dbt run` failed at 16:21:28.404933 after 0.45 seconds
[0m16:21:28.405100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106310dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122be7d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122be7830>]}
[0m16:21:28.405220 [debug] [MainThread]: Flushing usage events
[0m16:21:28.985883 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:21:46.076362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11221fb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113867c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113867ed0>]}


============================== 16:21:46.078540 | f8442a99-7a60-47ad-a512-bf46cc49668e ==============================
[0m16:21:46.078540 [info ] [MainThread]: Running with dbt=1.10.15
[0m16:21:46.078779 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'printer_width': '80', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'profiles_dir': '.', 'invocation_command': 'dbt run --select fct_dead_money_by_player --profiles-dir .', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'empty': 'False', 'warn_error': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_path': '/Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/logs', 'version_check': 'True'}
[0m16:21:46.151285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8442a99-7a60-47ad-a512-bf46cc49668e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128b10f0>]}
[0m16:21:46.176061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8442a99-7a60-47ad-a512-bf46cc49668e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a91ae0>]}
[0m16:21:46.177190 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:21:46.213405 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m16:21:46.264408 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:21:46.264589 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:21:46.267324 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.nfl_dead_money.spotrac_team_cap
[0m16:21:46.287714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8442a99-7a60-47ad-a512-bf46cc49668e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115bb6e50>]}
[0m16:21:46.325457 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/manifest.json
[0m16:21:46.326314 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/semantic_manifest.json
[0m16:21:46.332349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8442a99-7a60-47ad-a512-bf46cc49668e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e29220>]}
[0m16:21:46.332536 [info ] [MainThread]: Found 10 models, 1 seed, 2 operations, 34 data tests, 4 sources, 469 macros
[0m16:21:46.332644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8442a99-7a60-47ad-a512-bf46cc49668e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115fb20b0>]}
[0m16:21:46.333324 [info ] [MainThread]: 
[0m16:21:46.333441 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:21:46.333523 [info ] [MainThread]: 
[0m16:21:46.333695 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:21:46.333995 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfl_dead_money'
[0m16:21:46.350653 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money"
[0m16:21:46.350796 [debug] [ThreadPool]: On list_nfl_dead_money: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"nfl_dead_money"'
    
  
  
[0m16:21:46.350886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:46.356456 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:21:46.356970 [debug] [ThreadPool]: On list_nfl_dead_money: Close
[0m16:21:46.357217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfl_dead_money, now create_nfl_dead_money_main_marts)
[0m16:21:46.357363 [debug] [ThreadPool]: Creating schema "database: "nfl_dead_money"
schema: "main_marts"
"
[0m16:21:46.359495 [debug] [ThreadPool]: Using duckdb connection "create_nfl_dead_money_main_marts"
[0m16:21:46.359593 [debug] [ThreadPool]: On create_nfl_dead_money_main_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "create_nfl_dead_money_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='nfl_dead_money'
        and type='sqlite'
    
  
[0m16:21:46.359677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:46.359988 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:21:46.360375 [debug] [ThreadPool]: Using duckdb connection "create_nfl_dead_money_main_marts"
[0m16:21:46.360457 [debug] [ThreadPool]: On create_nfl_dead_money_main_marts: BEGIN
[0m16:21:46.360604 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:21:46.360690 [debug] [ThreadPool]: Using duckdb connection "create_nfl_dead_money_main_marts"
[0m16:21:46.360769 [debug] [ThreadPool]: On create_nfl_dead_money_main_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "create_nfl_dead_money_main_marts"} */

    
    
        create schema if not exists "nfl_dead_money"."main_marts"
    
[0m16:21:46.360937 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:21:46.361168 [debug] [ThreadPool]: On create_nfl_dead_money_main_marts: COMMIT
[0m16:21:46.361253 [debug] [ThreadPool]: Using duckdb connection "create_nfl_dead_money_main_marts"
[0m16:21:46.361329 [debug] [ThreadPool]: On create_nfl_dead_money_main_marts: COMMIT
[0m16:21:46.361464 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:21:46.361545 [debug] [ThreadPool]: On create_nfl_dead_money_main_marts: Close
[0m16:21:46.363457 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_nfl_dead_money_main_marts, now list_nfl_dead_money_main)
[0m16:21:46.365266 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main"
[0m16:21:46.365446 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfl_dead_money_main_marts'
[0m16:21:46.365542 [debug] [ThreadPool]: On list_nfl_dead_money_main: BEGIN
[0m16:21:46.365686 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfl_dead_money_main_staging'
[0m16:21:46.366182 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_marts"
[0m16:21:46.366307 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfl_dead_money_main_intermediate'
[0m16:21:46.366411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:46.366943 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_staging"
[0m16:21:46.367040 [debug] [ThreadPool]: On list_nfl_dead_money_main_marts: BEGIN
[0m16:21:46.367593 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_intermediate"
[0m16:21:46.367770 [debug] [ThreadPool]: On list_nfl_dead_money_main_staging: BEGIN
[0m16:21:46.367894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:46.368009 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:21:46.368139 [debug] [ThreadPool]: On list_nfl_dead_money_main_intermediate: BEGIN
[0m16:21:46.368255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:46.368417 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main"
[0m16:21:46.368523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:46.368622 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:21:46.368777 [debug] [ThreadPool]: On list_nfl_dead_money_main: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money_main"} */
select
      'nfl_dead_money' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'nfl_dead_money'
  
[0m16:21:46.368933 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:21:46.369036 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_marts"
[0m16:21:46.369163 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:21:46.369301 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_staging"
[0m16:21:46.369421 [debug] [ThreadPool]: On list_nfl_dead_money_main_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money_main_marts"} */
select
      'nfl_dead_money' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'nfl_dead_money'
  
[0m16:21:46.369524 [debug] [ThreadPool]: Using duckdb connection "list_nfl_dead_money_main_intermediate"
[0m16:21:46.369626 [debug] [ThreadPool]: On list_nfl_dead_money_main_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money_main_staging"} */
select
      'nfl_dead_money' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'nfl_dead_money'
  
[0m16:21:46.369797 [debug] [ThreadPool]: On list_nfl_dead_money_main_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "connection_name": "list_nfl_dead_money_main_intermediate"} */
select
      'nfl_dead_money' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_intermediate'
    and lower(table_catalog) = 'nfl_dead_money'
  
[0m16:21:46.374672 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:21:46.374833 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:21:46.374947 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:21:46.375098 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:21:46.375521 [debug] [ThreadPool]: On list_nfl_dead_money_main_intermediate: ROLLBACK
[0m16:21:46.375920 [debug] [ThreadPool]: On list_nfl_dead_money_main_marts: ROLLBACK
[0m16:21:46.376348 [debug] [ThreadPool]: On list_nfl_dead_money_main_staging: ROLLBACK
[0m16:21:46.376698 [debug] [ThreadPool]: On list_nfl_dead_money_main: ROLLBACK
[0m16:21:46.377217 [debug] [ThreadPool]: Failed to rollback 'list_nfl_dead_money_main_intermediate'
[0m16:21:46.377401 [debug] [ThreadPool]: Failed to rollback 'list_nfl_dead_money_main'
[0m16:21:46.377582 [debug] [ThreadPool]: Failed to rollback 'list_nfl_dead_money_main_marts'
[0m16:21:46.377682 [debug] [ThreadPool]: On list_nfl_dead_money_main_intermediate: Close
[0m16:21:46.377862 [debug] [ThreadPool]: Failed to rollback 'list_nfl_dead_money_main_staging'
[0m16:21:46.377943 [debug] [ThreadPool]: On list_nfl_dead_money_main: Close
[0m16:21:46.378029 [debug] [ThreadPool]: On list_nfl_dead_money_main_marts: Close
[0m16:21:46.378139 [debug] [ThreadPool]: On list_nfl_dead_money_main_staging: Close
[0m16:21:46.378780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8442a99-7a60-47ad-a512-bf46cc49668e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1162ef110>]}
[0m16:21:46.378939 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:46.379020 [debug] [MainThread]: On master: BEGIN
[0m16:21:46.379093 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:21:46.379287 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:21:46.379368 [debug] [MainThread]: On master: COMMIT
[0m16:21:46.379440 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:46.379509 [debug] [MainThread]: On master: COMMIT
[0m16:21:46.379678 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:21:46.382188 [info ] [MainThread]: Starting dbt run for NFL dead money data pipeline
[0m16:21:46.382351 [debug] [MainThread]: Writing injected SQL for node "operation.nfl_dead_money.nfl_dead_money-on-run-start-0"
[0m16:21:46.383817 [info ] [MainThread]: 1 of 1 START hook: nfl_dead_money.on-run-start.0 ............................... [RUN]
[0m16:21:46.383979 [info ] [MainThread]: 1 of 1 OK hook: nfl_dead_money.on-run-start.0 .................................. [[32mOK[0m in 0.00s]
[0m16:21:46.384076 [info ] [MainThread]: 
[0m16:21:46.384175 [debug] [MainThread]: On master: Close
[0m16:21:46.384996 [debug] [Thread-1 (]: Began running node model.nfl_dead_money.fct_dead_money_by_player
[0m16:21:46.385157 [info ] [Thread-1 (]: 1 of 1 START sql table model main_marts.fct_dead_money_by_player ............... [RUN]
[0m16:21:46.385288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nfl_dead_money_main, now model.nfl_dead_money.fct_dead_money_by_player)
[0m16:21:46.385387 [debug] [Thread-1 (]: Began compiling node model.nfl_dead_money.fct_dead_money_by_player
[0m16:21:46.386631 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfl_dead_money.fct_dead_money_by_player"
[0m16:21:46.386907 [debug] [Thread-1 (]: Began executing node model.nfl_dead_money.fct_dead_money_by_player
[0m16:21:46.396697 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfl_dead_money.fct_dead_money_by_player"
[0m16:21:46.396950 [debug] [Thread-1 (]: Using duckdb connection "model.nfl_dead_money.fct_dead_money_by_player"
[0m16:21:46.397055 [debug] [Thread-1 (]: On model.nfl_dead_money.fct_dead_money_by_player: BEGIN
[0m16:21:46.397151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:46.397373 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:21:46.397466 [debug] [Thread-1 (]: Using duckdb connection "model.nfl_dead_money.fct_dead_money_by_player"
[0m16:21:46.397592 [debug] [Thread-1 (]: On model.nfl_dead_money.fct_dead_money_by_player: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "node_id": "model.nfl_dead_money.fct_dead_money_by_player"} */

  
    
    

    create  table
      "nfl_dead_money"."main_marts"."fct_dead_money_by_player__dbt_tmp"
  
    as (
      

-- Dead money by player: for player-level analysis with percentile ranks
-- Filter: only include players with > $1M dead cap (avoid noise from minor charges)
with player_dm as (
  select
    player_name,
    team,
    year,
    dead_cap_millions
  from "nfl_dead_money"."main_staging"."stg_spotrac_dead_money"
  where dead_cap_millions > 1.0
),

team_totals as (
  select
    team,
    year,
    sum(dead_cap_millions) as team_total_dead_money_millions
  from player_dm
  group by team, year
),

nfl_stats as (
  select
    year,
    sum(dead_cap_millions) as nfl_total_dead_money_millions,
    avg(dead_cap_millions) as nfl_avg_dead_cap,
    stddev_pop(dead_cap_millions) as nfl_stddev_dead_cap,
    percentile_cont(0.75) within group (order by dead_cap_millions) as p75_dead_cap,
    percentile_cont(0.90) within group (order by dead_cap_millions) as p90_dead_cap,
    percentile_cont(0.95) within group (order by dead_cap_millions) as p95_dead_cap
  from player_dm
  group by year
),

player_with_percentile as (
  select
    p.player_name,
    p.team,
    p.year,
    p.dead_cap_millions,
    t.team_total_dead_money_millions,
    round((p.dead_cap_millions / t.team_total_dead_money_millions * 100)::numeric, 2) as pct_of_team_dead_money,
    n.nfl_total_dead_money_millions,
    round((p.dead_cap_millions / n.nfl_total_dead_money_millions * 100)::numeric, 4) as pct_of_nfl_dead_money,
    percent_rank() over (partition by p.year order by p.dead_cap_millions) as percentile_rank,
    round((percent_rank() over (partition by p.year order by p.dead_cap_millions) * 100)::numeric, 1) as nfl_percentile
  from player_dm p
  join team_totals t on p.team = t.team and p.year = t.year
  join nfl_stats n on p.year = n.year
)

select
  player_name,
  team,
  year,
  round(dead_cap_millions::numeric, 2) as dead_cap_millions,
  round(team_total_dead_money_millions::numeric, 2) as team_total_dead_money_millions,
  pct_of_team_dead_money,
  round(nfl_total_dead_money_millions::numeric, 2) as nfl_total_dead_money_millions,
  pct_of_nfl_dead_money,
  nfl_percentile,
  row_number() over (partition by year order by dead_cap_millions desc) as rank_in_year
from player_with_percentile
order by year, dead_cap_millions desc
    );
  
  
[0m16:21:46.402652 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:21:46.404596 [debug] [Thread-1 (]: Using duckdb connection "model.nfl_dead_money.fct_dead_money_by_player"
[0m16:21:46.404727 [debug] [Thread-1 (]: On model.nfl_dead_money.fct_dead_money_by_player: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "node_id": "model.nfl_dead_money.fct_dead_money_by_player"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'fct_dead_money_by_player'
  
[0m16:21:46.405054 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:21:46.405463 [debug] [Thread-1 (]: Using duckdb connection "model.nfl_dead_money.fct_dead_money_by_player"
[0m16:21:46.405569 [debug] [Thread-1 (]: On model.nfl_dead_money.fct_dead_money_by_player: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "node_id": "model.nfl_dead_money.fct_dead_money_by_player"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_marts'
      AND table_name = 'fct_dead_money_by_player'
  
[0m16:21:46.405845 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:21:46.407907 [debug] [Thread-1 (]: Using duckdb connection "model.nfl_dead_money.fct_dead_money_by_player"
[0m16:21:46.408017 [debug] [Thread-1 (]: On model.nfl_dead_money.fct_dead_money_by_player: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "node_id": "model.nfl_dead_money.fct_dead_money_by_player"} */
alter table "nfl_dead_money"."main_marts"."fct_dead_money_by_player" rename to "fct_dead_money_by_player__dbt_backup"
[0m16:21:46.408244 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:21:46.408987 [debug] [Thread-1 (]: Using duckdb connection "model.nfl_dead_money.fct_dead_money_by_player"
[0m16:21:46.409090 [debug] [Thread-1 (]: On model.nfl_dead_money.fct_dead_money_by_player: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "node_id": "model.nfl_dead_money.fct_dead_money_by_player"} */
alter table "nfl_dead_money"."main_marts"."fct_dead_money_by_player__dbt_tmp" rename to "fct_dead_money_by_player"
[0m16:21:46.409291 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:21:46.413927 [debug] [Thread-1 (]: On model.nfl_dead_money.fct_dead_money_by_player: COMMIT
[0m16:21:46.414045 [debug] [Thread-1 (]: Using duckdb connection "model.nfl_dead_money.fct_dead_money_by_player"
[0m16:21:46.414142 [debug] [Thread-1 (]: On model.nfl_dead_money.fct_dead_money_by_player: COMMIT
[0m16:21:46.414728 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:21:46.416203 [debug] [Thread-1 (]: Using duckdb connection "model.nfl_dead_money.fct_dead_money_by_player"
[0m16:21:46.416307 [debug] [Thread-1 (]: On model.nfl_dead_money.fct_dead_money_by_player: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "nfl_dead_money", "target_name": "dev", "node_id": "model.nfl_dead_money.fct_dead_money_by_player"} */

      drop table if exists "nfl_dead_money"."main_marts"."fct_dead_money_by_player__dbt_backup" cascade
    
[0m16:21:46.416600 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:21:46.417485 [debug] [Thread-1 (]: On model.nfl_dead_money.fct_dead_money_by_player: Close
[0m16:21:46.418104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8442a99-7a60-47ad-a512-bf46cc49668e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1164eca10>]}
[0m16:21:46.418344 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_marts.fct_dead_money_by_player .......... [[32mOK[0m in 0.03s]
[0m16:21:46.418523 [debug] [Thread-1 (]: Finished running node model.nfl_dead_money.fct_dead_money_by_player
[0m16:21:46.419138 [info ] [MainThread]: 
[0m16:21:46.419265 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:46.419347 [debug] [MainThread]: On master: BEGIN
[0m16:21:46.419424 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:21:46.419604 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:21:46.419690 [debug] [MainThread]: On master: COMMIT
[0m16:21:46.419776 [debug] [MainThread]: Using duckdb connection "master"
[0m16:21:46.419853 [debug] [MainThread]: On master: COMMIT
[0m16:21:46.419984 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:21:46.420762 [info ] [MainThread]: Completed dbt run
[0m16:21:46.420880 [debug] [MainThread]: Writing injected SQL for node "operation.nfl_dead_money.nfl_dead_money-on-run-end-0"
[0m16:21:46.421056 [info ] [MainThread]: 1 of 1 START hook: nfl_dead_money.on-run-end.0 ................................. [RUN]
[0m16:21:46.421183 [info ] [MainThread]: 1 of 1 OK hook: nfl_dead_money.on-run-end.0 .................................... [[32mOK[0m in 0.00s]
[0m16:21:46.421273 [debug] [MainThread]: On master: Close
[0m16:21:46.421382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:21:46.421456 [debug] [MainThread]: Connection 'model.nfl_dead_money.fct_dead_money_by_player' was properly closed.
[0m16:21:46.421522 [debug] [MainThread]: Connection 'list_nfl_dead_money_main_marts' was properly closed.
[0m16:21:46.421585 [debug] [MainThread]: Connection 'list_nfl_dead_money_main_staging' was properly closed.
[0m16:21:46.421649 [debug] [MainThread]: Connection 'list_nfl_dead_money_main_intermediate' was properly closed.
[0m16:21:46.421748 [info ] [MainThread]: 
[0m16:21:46.421837 [info ] [MainThread]: Finished running 2 project hooks, 1 table model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m16:21:46.422091 [debug] [MainThread]: Command end result
[0m16:21:46.480909 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/manifest.json
[0m16:21:46.481683 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/semantic_manifest.json
[0m16:21:46.483712 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/andrewsmith/Documents/portfolio/nfl-dead-money/dbt/target/run_results.json
[0m16:21:46.483816 [info ] [MainThread]: 
[0m16:21:46.483931 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:21:46.484017 [info ] [MainThread]: 
[0m16:21:46.484114 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m16:21:46.485072 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.43277255, "process_in_blocks": "0", "process_kernel_time": 0.123992, "process_mem_max_rss": "192708608", "process_out_blocks": "0", "process_user_time": 1.159246}
[0m16:21:46.485215 [debug] [MainThread]: Command `dbt run` succeeded at 16:21:46.485187 after 0.43 seconds
[0m16:21:46.485334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116167b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e36710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e36ad0>]}
[0m16:21:46.485442 [debug] [MainThread]: Flushing usage events
[0m16:21:47.156474 [debug] [MainThread]: An error was encountered while trying to flush usage events
